---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_in_loop.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
sum.42 = temp.41
temp.43 = int 1
temp.44 = int 1
p.x.45 = temp.43
p.y.46 = temp.44
temp.47 = int 0
i.48 = temp.47
jmp 0

---- block 0 ----
i.49 = φ(i.48 from 2, i.83 from 5)
sum.53 = φ(sum.42 from 2, sum.67 from 5)
p.x.57 = φ(p.x.45 from 2, p.x.73 from 5)
p.y.59 = φ(p.y.46 from 2, p.y.79 from 5)
temp.50 = i.49
temp.51 = int 5
temp.52 = temp.50 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
jmp 1

---- block 4 ----
jmp 5

---- block 1 ----
temp.54 = sum.53
temp.55 = temp.54
storeprop temp.55, 0
return 

---- block 5 ----
temp.56 = sum.53
temp.18.x.58 = p.x.57
temp.18.y.60 = p.y.59
temp.61 = temp.18.x.58
temp.62 = temp.56 + temp.61
temp.21.x.63 = p.x.57
temp.21.y.64 = p.y.59
temp.65 = temp.21.y.64
temp.66 = temp.62 + temp.65
sum.67 = temp.66
temp.27.x.68 = p.x.57
temp.27.y.69 = p.y.59
temp.70 = temp.27.x.68
temp.71 = int 1
temp.72 = temp.70 + temp.71
p.x.73 = temp.72
temp.33.x.74 = p.x.73
temp.33.y.75 = p.y.59
temp.76 = temp.33.y.75
temp.77 = int 1
temp.78 = temp.76 + temp.77
p.y.79 = temp.78
temp.80 = i.49
temp.81 = int 1
temp.82 = temp.80 + temp.81
i.83 = temp.82
jmp 0


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
sum.42 = temp.41
temp.43 = int 1
temp.44 = int 1
p.x.45 = temp.43
p.y.46 = temp.44
temp.47 = int 0
i.48 = temp.47
jmp 0

---- block 0 ----
i.49 = φ(i.48 from 2, i.83 from 5)
sum.53 = φ(sum.42 from 2, sum.67 from 5)
p.x.57 = φ(p.x.45 from 2, p.x.73 from 5)
p.y.59 = φ(p.y.46 from 2, p.y.79 from 5)
temp.50 = i.49
temp.51 = int 5
temp.52 = temp.50 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
temp.54 = sum.53
temp.55 = temp.54
storeprop temp.55, 0
jmp 1

---- block 4 ----
temp.56 = sum.53
temp.18.x.58 = p.x.57
temp.18.y.60 = p.y.59
temp.61 = temp.18.x.58
temp.62 = temp.56 + temp.61
temp.21.x.63 = p.x.57
temp.21.y.64 = p.y.59
temp.65 = temp.21.y.64
temp.66 = temp.62 + temp.65
sum.67 = temp.66
temp.27.x.68 = p.x.57
temp.27.y.69 = p.y.59
temp.70 = temp.27.x.68
temp.71 = int 1
temp.72 = temp.70 + temp.71
p.x.73 = temp.72
temp.33.x.74 = p.x.73
temp.33.y.75 = p.y.59
temp.76 = temp.33.y.75
temp.77 = int 1
temp.78 = temp.76 + temp.77
p.y.79 = temp.78
temp.80 = i.49
temp.81 = int 1
temp.82 = temp.80 + temp.81
i.83 = temp.82
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
sum.42 = temp.41
temp.43 = int 1
temp.44 = int 1
p.x.45 = temp.43
p.y.46 = temp.44
temp.47 = int 0
i.48 = temp.47
jmp 0

---- block 0 ----
i.49 = φ(temp.47 from 2, i.83 from 5)
sum.53 = φ(temp.41 from 2, sum.67 from 5)
p.x.57 = φ(temp.43 from 2, p.x.73 from 5)
p.y.59 = φ(temp.44 from 2, p.y.79 from 5)
temp.50 = i.49
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
temp.54 = sum.53
temp.55 = sum.53
storeprop sum.53, 0
jmp 1

---- block 4 ----
temp.56 = sum.53
temp.18.x.58 = p.x.57
temp.18.y.60 = p.y.59
temp.61 = p.x.57
temp.62 = sum.53 + p.x.57
temp.21.x.63 = p.x.57
temp.21.y.64 = p.y.59
temp.65 = p.y.59
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.27.x.68 = p.x.57
temp.27.y.69 = p.y.59
temp.70 = p.x.57
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.33.x.74 = temp.72
temp.33.y.75 = p.y.59
temp.76 = p.y.59
temp.77 = int 1
temp.78 = p.y.59 + temp.77
p.y.79 = temp.78
temp.80 = i.49
temp.81 = int 1
temp.82 = i.49 + temp.81
i.83 = temp.82
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
temp.44 = int 1
temp.47 = int 0
jmp 0

---- block 0 ----
i.49 = φ(temp.47 from 2, i.83 from 5)
sum.53 = φ(temp.41 from 2, sum.67 from 5)
p.x.57 = φ(temp.43 from 2, p.x.73 from 5)
p.y.59 = φ(temp.44 from 2, p.y.79 from 5)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
jmp 1

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.77 = int 1
temp.78 = p.y.59 + temp.77
p.y.79 = temp.78
temp.81 = int 1
temp.82 = i.49 + temp.81
i.83 = temp.82
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
temp.44 = temp.43
temp.47 = temp.41
jmp 0

---- block 0 ----
i.49 = φ(temp.47 from 2, i.83 from 5)
sum.53 = φ(temp.41 from 2, sum.67 from 5)
p.x.57 = φ(temp.43 from 2, p.x.73 from 5)
p.y.59 = φ(temp.44 from 2, p.y.79 from 5)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
jmp 1

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.77 = temp.71
temp.78 = p.y.59 + temp.77
p.y.79 = temp.78
temp.81 = temp.71
temp.82 = i.49 + temp.81
i.83 = temp.82
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
temp.44 = temp.43
temp.47 = temp.41
jmp 0

---- block 0 ----
i.49 = φ(temp.47 from 2, i.83 from 5, i.83 from 4)
sum.53 = φ(temp.41 from 2, sum.67 from 5, sum.67 from 4)
p.x.57 = φ(temp.43 from 2, p.x.73 from 5, p.x.73 from 4)
p.y.59 = φ(temp.44 from 2, p.y.79 from 5, p.y.79 from 4)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
return 

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.77 = temp.71
temp.78 = p.y.59 + temp.77
p.y.79 = temp.78
temp.81 = temp.71
temp.82 = i.49 + temp.81
i.83 = temp.82
jmp 0


----------- unreferenced_blocks_in_phi -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
temp.44 = temp.43
temp.47 = temp.41
jmp 0

---- block 0 ----
i.49 = φ(temp.47 from 2, i.83 from 4)
sum.53 = φ(temp.41 from 2, sum.67 from 4)
p.x.57 = φ(temp.43 from 2, p.x.73 from 4)
p.y.59 = φ(temp.44 from 2, p.y.79 from 4)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
return 

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.77 = temp.71
temp.78 = p.y.59 + temp.77
p.y.79 = temp.78
temp.81 = temp.71
temp.82 = i.49 + temp.81
i.83 = temp.82
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
temp.44 = temp.43
temp.47 = temp.41
jmp 0

---- block 0 ----
i.49 = φ(temp.41 from 2, i.83 from 4)
sum.53 = φ(temp.41 from 2, sum.67 from 4)
p.x.57 = φ(temp.43 from 2, p.x.73 from 4)
p.y.59 = φ(temp.43 from 2, p.y.79 from 4)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
return 

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.77 = temp.71
temp.78 = p.y.59 + temp.71
p.y.79 = temp.78
temp.81 = temp.71
temp.82 = i.49 + temp.71
i.83 = temp.82
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.41 = int 0
temp.43 = int 1
jmp 0

---- block 0 ----
i.49 = φ(temp.41 from 2, i.83 from 4)
sum.53 = φ(temp.41 from 2, sum.67 from 4)
p.x.57 = φ(temp.43 from 2, p.x.73 from 4)
p.y.59 = φ(temp.43 from 2, p.y.79 from 4)
temp.51 = int 5
temp.52 = i.49 >= temp.51
conditional_jump temp.52 3 4

---- block 3 ----
storeprop sum.53, 0
return 

---- block 4 ----
temp.62 = sum.53 + p.x.57
temp.66 = temp.62 + p.y.59
sum.67 = temp.66
temp.71 = int 1
temp.72 = p.x.57 + temp.71
p.x.73 = temp.72
temp.78 = p.y.59 + temp.71
p.y.79 = temp.78
temp.82 = i.49 + temp.71
i.83 = temp.82
jmp 0
