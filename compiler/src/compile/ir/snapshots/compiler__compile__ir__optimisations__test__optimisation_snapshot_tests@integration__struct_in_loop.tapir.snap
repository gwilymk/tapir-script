---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_in_loop.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
sum.52 = temp.51
temp.53 = int 1
temp.54 = int 1
temp.5.x.55 = temp.53
temp.5.y.56 = temp.54
p.x.57 = temp.5.x.55
p.y.58 = temp.5.y.56
temp.59 = int 0
i.60 = temp.59
jmp 0

---- block 0 ----
i.61 = φ(i.60 from 2, i.102 from 5)
sum.65 = φ(sum.52 from 2, sum.82 from 5)
p.x.68 = φ(p.x.57 from 2, p.x.90 from 5)
p.y.71 = φ(p.y.58 from 2, p.y.98 from 5)
temp.62 = i.61
temp.63 = int 5
temp.64 = temp.62 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
jmp 1

---- block 4 ----
jmp 5

---- block 1 ----
temp.66 = sum.65
storeprop temp.66, 0
return 

---- block 5 ----
temp.67 = sum.65
temp.69 = p.x.68
temp.21.x.70 = temp.69
temp.72 = p.y.71
temp.21.y.73 = temp.72
temp.74 = temp.21.x.70
temp.75 = temp.67 + temp.74
temp.76 = p.x.68
temp.26.x.77 = temp.76
temp.78 = p.y.71
temp.26.y.79 = temp.78
temp.80 = temp.26.y.79
temp.81 = temp.75 + temp.80
sum.82 = temp.81
temp.83 = p.x.68
temp.34.x.84 = temp.83
temp.85 = p.y.71
temp.34.y.86 = temp.85
temp.87 = temp.34.x.84
temp.88 = int 1
temp.89 = temp.87 + temp.88
p.x.90 = temp.89
temp.91 = p.x.90
temp.42.x.92 = temp.91
temp.93 = p.y.71
temp.42.y.94 = temp.93
temp.95 = temp.42.y.94
temp.96 = int 1
temp.97 = temp.95 + temp.96
p.y.98 = temp.97
temp.99 = i.61
temp.100 = int 1
temp.101 = temp.99 + temp.100
i.102 = temp.101
jmp 0


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
sum.52 = temp.51
temp.53 = int 1
temp.54 = int 1
temp.5.x.55 = temp.53
temp.5.y.56 = temp.54
p.x.57 = temp.5.x.55
p.y.58 = temp.5.y.56
temp.59 = int 0
i.60 = temp.59
jmp 0

---- block 0 ----
i.61 = φ(i.60 from 2, i.102 from 5)
sum.65 = φ(sum.52 from 2, sum.82 from 5)
p.x.68 = φ(p.x.57 from 2, p.x.90 from 5)
p.y.71 = φ(p.y.58 from 2, p.y.98 from 5)
temp.62 = i.61
temp.63 = int 5
temp.64 = temp.62 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
temp.66 = sum.65
storeprop temp.66, 0
jmp 1

---- block 4 ----
temp.67 = sum.65
temp.69 = p.x.68
temp.21.x.70 = temp.69
temp.72 = p.y.71
temp.21.y.73 = temp.72
temp.74 = temp.21.x.70
temp.75 = temp.67 + temp.74
temp.76 = p.x.68
temp.26.x.77 = temp.76
temp.78 = p.y.71
temp.26.y.79 = temp.78
temp.80 = temp.26.y.79
temp.81 = temp.75 + temp.80
sum.82 = temp.81
temp.83 = p.x.68
temp.34.x.84 = temp.83
temp.85 = p.y.71
temp.34.y.86 = temp.85
temp.87 = temp.34.x.84
temp.88 = int 1
temp.89 = temp.87 + temp.88
p.x.90 = temp.89
temp.91 = p.x.90
temp.42.x.92 = temp.91
temp.93 = p.y.71
temp.42.y.94 = temp.93
temp.95 = temp.42.y.94
temp.96 = int 1
temp.97 = temp.95 + temp.96
p.y.98 = temp.97
temp.99 = i.61
temp.100 = int 1
temp.101 = temp.99 + temp.100
i.102 = temp.101
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
sum.52 = temp.51
temp.53 = int 1
temp.54 = int 1
temp.5.x.55 = temp.53
temp.5.y.56 = temp.54
p.x.57 = temp.53
p.y.58 = temp.54
temp.59 = int 0
i.60 = temp.59
jmp 0

---- block 0 ----
i.61 = φ(temp.59 from 2, i.102 from 5)
sum.65 = φ(temp.51 from 2, sum.82 from 5)
p.x.68 = φ(temp.53 from 2, p.x.90 from 5)
p.y.71 = φ(temp.54 from 2, p.y.98 from 5)
temp.62 = i.61
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
temp.66 = sum.65
storeprop sum.65, 0
jmp 1

---- block 4 ----
temp.67 = sum.65
temp.69 = p.x.68
temp.21.x.70 = p.x.68
temp.72 = p.y.71
temp.21.y.73 = p.y.71
temp.74 = p.x.68
temp.75 = sum.65 + p.x.68
temp.76 = p.x.68
temp.26.x.77 = p.x.68
temp.78 = p.y.71
temp.26.y.79 = p.y.71
temp.80 = p.y.71
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.83 = p.x.68
temp.34.x.84 = p.x.68
temp.85 = p.y.71
temp.34.y.86 = p.y.71
temp.87 = p.x.68
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.91 = temp.89
temp.42.x.92 = temp.89
temp.93 = p.y.71
temp.42.y.94 = p.y.71
temp.95 = p.y.71
temp.96 = int 1
temp.97 = p.y.71 + temp.96
p.y.98 = temp.97
temp.99 = i.61
temp.100 = int 1
temp.101 = i.61 + temp.100
i.102 = temp.101
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
temp.54 = int 1
temp.59 = int 0
jmp 0

---- block 0 ----
i.61 = φ(temp.59 from 2, i.102 from 5)
sum.65 = φ(temp.51 from 2, sum.82 from 5)
p.x.68 = φ(temp.53 from 2, p.x.90 from 5)
p.y.71 = φ(temp.54 from 2, p.y.98 from 5)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
jmp 1

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.96 = int 1
temp.97 = p.y.71 + temp.96
p.y.98 = temp.97
temp.100 = int 1
temp.101 = i.61 + temp.100
i.102 = temp.101
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
temp.54 = temp.53
temp.59 = temp.51
jmp 0

---- block 0 ----
i.61 = φ(temp.59 from 2, i.102 from 5)
sum.65 = φ(temp.51 from 2, sum.82 from 5)
p.x.68 = φ(temp.53 from 2, p.x.90 from 5)
p.y.71 = φ(temp.54 from 2, p.y.98 from 5)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
jmp 1

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.96 = temp.88
temp.97 = p.y.71 + temp.96
p.y.98 = temp.97
temp.100 = temp.88
temp.101 = i.61 + temp.100
i.102 = temp.101
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
temp.54 = temp.53
temp.59 = temp.51
jmp 0

---- block 0 ----
i.61 = φ(temp.59 from 2, i.102 from 5, i.102 from 4)
sum.65 = φ(temp.51 from 2, sum.82 from 5, sum.82 from 4)
p.x.68 = φ(temp.53 from 2, p.x.90 from 5, p.x.90 from 4)
p.y.71 = φ(temp.54 from 2, p.y.98 from 5, p.y.98 from 4)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
return 

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.96 = temp.88
temp.97 = p.y.71 + temp.96
p.y.98 = temp.97
temp.100 = temp.88
temp.101 = i.61 + temp.100
i.102 = temp.101
jmp 0


----------- unreferenced_blocks_in_phi -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
temp.54 = temp.53
temp.59 = temp.51
jmp 0

---- block 0 ----
i.61 = φ(temp.59 from 2, i.102 from 4)
sum.65 = φ(temp.51 from 2, sum.82 from 4)
p.x.68 = φ(temp.53 from 2, p.x.90 from 4)
p.y.71 = φ(temp.54 from 2, p.y.98 from 4)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
return 

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.96 = temp.88
temp.97 = p.y.71 + temp.96
p.y.98 = temp.97
temp.100 = temp.88
temp.101 = i.61 + temp.100
i.102 = temp.101
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
temp.54 = temp.53
temp.59 = temp.51
jmp 0

---- block 0 ----
i.61 = φ(temp.51 from 2, i.102 from 4)
sum.65 = φ(temp.51 from 2, sum.82 from 4)
p.x.68 = φ(temp.53 from 2, p.x.90 from 4)
p.y.71 = φ(temp.53 from 2, p.y.98 from 4)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
return 

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.96 = temp.88
temp.97 = p.y.71 + temp.88
p.y.98 = temp.97
temp.100 = temp.88
temp.101 = i.61 + temp.88
i.102 = temp.101
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.51 = int 0
temp.53 = int 1
jmp 0

---- block 0 ----
i.61 = φ(temp.51 from 2, i.102 from 4)
sum.65 = φ(temp.51 from 2, sum.82 from 4)
p.x.68 = φ(temp.53 from 2, p.x.90 from 4)
p.y.71 = φ(temp.53 from 2, p.y.98 from 4)
temp.63 = int 5
temp.64 = i.61 >= temp.63
conditional_jump temp.64 3 4

---- block 3 ----
storeprop sum.65, 0
return 

---- block 4 ----
temp.75 = sum.65 + p.x.68
temp.81 = temp.75 + p.y.71
sum.82 = temp.81
temp.88 = int 1
temp.89 = p.x.68 + temp.88
p.x.90 = temp.89
temp.97 = p.y.71 + temp.88
p.y.98 = temp.97
temp.101 = i.61 + temp.88
i.102 = temp.101
jmp 0
