---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_in_loop.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
sum.59 = temp.58
temp.60 = int 1
temp.61 = int 1
temp.6.x.62 = temp.60
temp.6.y.63 = temp.61
temp.64 = temp.6.x.62
temp.5.x.65 = temp.64
temp.66 = temp.6.y.63
temp.5.y.67 = temp.66
temp.68 = temp.5.x.65
p.x.69 = temp.68
temp.70 = temp.5.y.67
p.y.71 = temp.70
temp.72 = int 0
i.73 = temp.72
jmp 0

---- block 0 ----
i.74 = φ(i.73 from 2, i.115 from 5)
sum.78 = φ(sum.59 from 2, sum.95 from 5)
p.x.81 = φ(p.x.69 from 2, p.x.103 from 5)
p.y.84 = φ(p.y.71 from 2, p.y.111 from 5)
temp.75 = i.74
temp.76 = int 5
temp.77 = temp.75 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
jmp 1

---- block 4 ----
jmp 5

---- block 1 ----
temp.79 = sum.78
storeprop temp.79, 0
return 

---- block 5 ----
temp.80 = sum.78
temp.82 = p.x.81
temp.28.x.83 = temp.82
temp.85 = p.y.84
temp.28.y.86 = temp.85
temp.87 = temp.28.x.83
temp.88 = temp.80 + temp.87
temp.89 = p.x.81
temp.33.x.90 = temp.89
temp.91 = p.y.84
temp.33.y.92 = temp.91
temp.93 = temp.33.y.92
temp.94 = temp.88 + temp.93
sum.95 = temp.94
temp.96 = p.x.81
temp.41.x.97 = temp.96
temp.98 = p.y.84
temp.41.y.99 = temp.98
temp.100 = temp.41.x.97
temp.101 = int 1
temp.102 = temp.100 + temp.101
p.x.103 = temp.102
temp.104 = p.x.103
temp.49.x.105 = temp.104
temp.106 = p.y.84
temp.49.y.107 = temp.106
temp.108 = temp.49.y.107
temp.109 = int 1
temp.110 = temp.108 + temp.109
p.y.111 = temp.110
temp.112 = i.74
temp.113 = int 1
temp.114 = temp.112 + temp.113
i.115 = temp.114
jmp 0


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
sum.59 = temp.58
temp.60 = int 1
temp.61 = int 1
temp.6.x.62 = temp.60
temp.6.y.63 = temp.61
temp.64 = temp.6.x.62
temp.5.x.65 = temp.64
temp.66 = temp.6.y.63
temp.5.y.67 = temp.66
temp.68 = temp.5.x.65
p.x.69 = temp.68
temp.70 = temp.5.y.67
p.y.71 = temp.70
temp.72 = int 0
i.73 = temp.72
jmp 0

---- block 0 ----
i.74 = φ(i.73 from 2, i.115 from 5)
sum.78 = φ(sum.59 from 2, sum.95 from 5)
p.x.81 = φ(p.x.69 from 2, p.x.103 from 5)
p.y.84 = φ(p.y.71 from 2, p.y.111 from 5)
temp.75 = i.74
temp.76 = int 5
temp.77 = temp.75 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
temp.79 = sum.78
storeprop temp.79, 0
jmp 1

---- block 4 ----
temp.80 = sum.78
temp.82 = p.x.81
temp.28.x.83 = temp.82
temp.85 = p.y.84
temp.28.y.86 = temp.85
temp.87 = temp.28.x.83
temp.88 = temp.80 + temp.87
temp.89 = p.x.81
temp.33.x.90 = temp.89
temp.91 = p.y.84
temp.33.y.92 = temp.91
temp.93 = temp.33.y.92
temp.94 = temp.88 + temp.93
sum.95 = temp.94
temp.96 = p.x.81
temp.41.x.97 = temp.96
temp.98 = p.y.84
temp.41.y.99 = temp.98
temp.100 = temp.41.x.97
temp.101 = int 1
temp.102 = temp.100 + temp.101
p.x.103 = temp.102
temp.104 = p.x.103
temp.49.x.105 = temp.104
temp.106 = p.y.84
temp.49.y.107 = temp.106
temp.108 = temp.49.y.107
temp.109 = int 1
temp.110 = temp.108 + temp.109
p.y.111 = temp.110
temp.112 = i.74
temp.113 = int 1
temp.114 = temp.112 + temp.113
i.115 = temp.114
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
sum.59 = temp.58
temp.60 = int 1
temp.61 = int 1
temp.6.x.62 = temp.60
temp.6.y.63 = temp.61
temp.64 = temp.60
temp.5.x.65 = temp.60
temp.66 = temp.61
temp.5.y.67 = temp.61
temp.68 = temp.60
p.x.69 = temp.60
temp.70 = temp.61
p.y.71 = temp.61
temp.72 = int 0
i.73 = temp.72
jmp 0

---- block 0 ----
i.74 = φ(temp.72 from 2, i.115 from 5)
sum.78 = φ(temp.58 from 2, sum.95 from 5)
p.x.81 = φ(temp.60 from 2, p.x.103 from 5)
p.y.84 = φ(temp.61 from 2, p.y.111 from 5)
temp.75 = i.74
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
temp.79 = sum.78
storeprop sum.78, 0
jmp 1

---- block 4 ----
temp.80 = sum.78
temp.82 = p.x.81
temp.28.x.83 = p.x.81
temp.85 = p.y.84
temp.28.y.86 = p.y.84
temp.87 = p.x.81
temp.88 = sum.78 + p.x.81
temp.89 = p.x.81
temp.33.x.90 = p.x.81
temp.91 = p.y.84
temp.33.y.92 = p.y.84
temp.93 = p.y.84
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.96 = p.x.81
temp.41.x.97 = p.x.81
temp.98 = p.y.84
temp.41.y.99 = p.y.84
temp.100 = p.x.81
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.104 = temp.102
temp.49.x.105 = temp.102
temp.106 = p.y.84
temp.49.y.107 = p.y.84
temp.108 = p.y.84
temp.109 = int 1
temp.110 = p.y.84 + temp.109
p.y.111 = temp.110
temp.112 = i.74
temp.113 = int 1
temp.114 = i.74 + temp.113
i.115 = temp.114
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
temp.61 = int 1
temp.72 = int 0
jmp 0

---- block 0 ----
i.74 = φ(temp.72 from 2, i.115 from 5)
sum.78 = φ(temp.58 from 2, sum.95 from 5)
p.x.81 = φ(temp.60 from 2, p.x.103 from 5)
p.y.84 = φ(temp.61 from 2, p.y.111 from 5)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
jmp 1

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.109 = int 1
temp.110 = p.y.84 + temp.109
p.y.111 = temp.110
temp.113 = int 1
temp.114 = i.74 + temp.113
i.115 = temp.114
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
temp.61 = temp.60
temp.72 = temp.58
jmp 0

---- block 0 ----
i.74 = φ(temp.72 from 2, i.115 from 5)
sum.78 = φ(temp.58 from 2, sum.95 from 5)
p.x.81 = φ(temp.60 from 2, p.x.103 from 5)
p.y.84 = φ(temp.61 from 2, p.y.111 from 5)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
jmp 1

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.109 = temp.101
temp.110 = p.y.84 + temp.109
p.y.111 = temp.110
temp.113 = temp.101
temp.114 = i.74 + temp.113
i.115 = temp.114
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
temp.61 = temp.60
temp.72 = temp.58
jmp 0

---- block 0 ----
i.74 = φ(temp.72 from 2, i.115 from 5, i.115 from 4)
sum.78 = φ(temp.58 from 2, sum.95 from 5, sum.95 from 4)
p.x.81 = φ(temp.60 from 2, p.x.103 from 5, p.x.103 from 4)
p.y.84 = φ(temp.61 from 2, p.y.111 from 5, p.y.111 from 4)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
return 

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.109 = temp.101
temp.110 = p.y.84 + temp.109
p.y.111 = temp.110
temp.113 = temp.101
temp.114 = i.74 + temp.113
i.115 = temp.114
jmp 0


----------- unreferenced_blocks_in_phi -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
temp.61 = temp.60
temp.72 = temp.58
jmp 0

---- block 0 ----
i.74 = φ(temp.72 from 2, i.115 from 4)
sum.78 = φ(temp.58 from 2, sum.95 from 4)
p.x.81 = φ(temp.60 from 2, p.x.103 from 4)
p.y.84 = φ(temp.61 from 2, p.y.111 from 4)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
return 

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.109 = temp.101
temp.110 = p.y.84 + temp.109
p.y.111 = temp.110
temp.113 = temp.101
temp.114 = i.74 + temp.113
i.115 = temp.114
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
temp.61 = temp.60
temp.72 = temp.58
jmp 0

---- block 0 ----
i.74 = φ(temp.58 from 2, i.115 from 4)
sum.78 = φ(temp.58 from 2, sum.95 from 4)
p.x.81 = φ(temp.60 from 2, p.x.103 from 4)
p.y.84 = φ(temp.60 from 2, p.y.111 from 4)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
return 

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.109 = temp.101
temp.110 = p.y.84 + temp.101
p.y.111 = temp.110
temp.113 = temp.101
temp.114 = i.74 + temp.101
i.115 = temp.114
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.58 = int 0
temp.60 = int 1
jmp 0

---- block 0 ----
i.74 = φ(temp.58 from 2, i.115 from 4)
sum.78 = φ(temp.58 from 2, sum.95 from 4)
p.x.81 = φ(temp.60 from 2, p.x.103 from 4)
p.y.84 = φ(temp.60 from 2, p.y.111 from 4)
temp.76 = int 5
temp.77 = i.74 >= temp.76
conditional_jump temp.77 3 4

---- block 3 ----
storeprop sum.78, 0
return 

---- block 4 ----
temp.88 = sum.78 + p.x.81
temp.94 = temp.88 + p.y.84
sum.95 = temp.94
temp.101 = int 1
temp.102 = p.x.81 + temp.101
p.x.103 = temp.102
temp.110 = p.y.84 + temp.101
p.y.111 = temp.110
temp.114 = i.74 + temp.101
i.115 = temp.114
jmp 0
