---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_in_loop.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
sum.44 = temp.43
temp.45 = int 1
temp.46 = int 1
temp.5.x.47 = temp.45
temp.5.y.48 = temp.46
p.x.49 = temp.5.x.47
p.y.50 = temp.5.y.48
temp.51 = int 0
i.52 = temp.51
jmp 0

---- block 0 ----
i.53 = φ(i.52 from 2, i.86 from 5)
sum.57 = φ(sum.44 from 2, sum.70 from 5)
p.x.60 = φ(p.x.49 from 2, p.x.76 from 5)
p.y.62 = φ(p.y.50 from 2, p.y.82 from 5)
temp.54 = i.53
temp.55 = int 5
temp.56 = temp.54 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
jmp 1

---- block 4 ----
jmp 5

---- block 1 ----
temp.58 = sum.57
storeprop temp.58, 0
return 

---- block 5 ----
temp.59 = sum.57
temp.21.x.61 = p.x.60
temp.21.y.63 = p.y.62
temp.64 = temp.21.x.61
temp.65 = temp.59 + temp.64
temp.24.x.66 = p.x.60
temp.24.y.67 = p.y.62
temp.68 = temp.24.y.67
temp.69 = temp.65 + temp.68
sum.70 = temp.69
temp.30.x.71 = p.x.60
temp.30.y.72 = p.y.62
temp.73 = temp.30.x.71
temp.74 = int 1
temp.75 = temp.73 + temp.74
p.x.76 = temp.75
temp.36.x.77 = p.x.76
temp.36.y.78 = p.y.62
temp.79 = temp.36.y.78
temp.80 = int 1
temp.81 = temp.79 + temp.80
p.y.82 = temp.81
temp.83 = i.53
temp.84 = int 1
temp.85 = temp.83 + temp.84
i.86 = temp.85
jmp 0


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
sum.44 = temp.43
temp.45 = int 1
temp.46 = int 1
temp.5.x.47 = temp.45
temp.5.y.48 = temp.46
p.x.49 = temp.5.x.47
p.y.50 = temp.5.y.48
temp.51 = int 0
i.52 = temp.51
jmp 0

---- block 0 ----
i.53 = φ(i.52 from 2, i.86 from 5)
sum.57 = φ(sum.44 from 2, sum.70 from 5)
p.x.60 = φ(p.x.49 from 2, p.x.76 from 5)
p.y.62 = φ(p.y.50 from 2, p.y.82 from 5)
temp.54 = i.53
temp.55 = int 5
temp.56 = temp.54 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
temp.58 = sum.57
storeprop temp.58, 0
jmp 1

---- block 4 ----
temp.59 = sum.57
temp.21.x.61 = p.x.60
temp.21.y.63 = p.y.62
temp.64 = temp.21.x.61
temp.65 = temp.59 + temp.64
temp.24.x.66 = p.x.60
temp.24.y.67 = p.y.62
temp.68 = temp.24.y.67
temp.69 = temp.65 + temp.68
sum.70 = temp.69
temp.30.x.71 = p.x.60
temp.30.y.72 = p.y.62
temp.73 = temp.30.x.71
temp.74 = int 1
temp.75 = temp.73 + temp.74
p.x.76 = temp.75
temp.36.x.77 = p.x.76
temp.36.y.78 = p.y.62
temp.79 = temp.36.y.78
temp.80 = int 1
temp.81 = temp.79 + temp.80
p.y.82 = temp.81
temp.83 = i.53
temp.84 = int 1
temp.85 = temp.83 + temp.84
i.86 = temp.85
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
sum.44 = temp.43
temp.45 = int 1
temp.46 = int 1
temp.5.x.47 = temp.45
temp.5.y.48 = temp.46
p.x.49 = temp.45
p.y.50 = temp.46
temp.51 = int 0
i.52 = temp.51
jmp 0

---- block 0 ----
i.53 = φ(temp.51 from 2, i.86 from 5)
sum.57 = φ(temp.43 from 2, sum.70 from 5)
p.x.60 = φ(temp.45 from 2, p.x.76 from 5)
p.y.62 = φ(temp.46 from 2, p.y.82 from 5)
temp.54 = i.53
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
temp.58 = sum.57
storeprop sum.57, 0
jmp 1

---- block 4 ----
temp.59 = sum.57
temp.21.x.61 = p.x.60
temp.21.y.63 = p.y.62
temp.64 = p.x.60
temp.65 = sum.57 + p.x.60
temp.24.x.66 = p.x.60
temp.24.y.67 = p.y.62
temp.68 = p.y.62
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.30.x.71 = p.x.60
temp.30.y.72 = p.y.62
temp.73 = p.x.60
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.36.x.77 = temp.75
temp.36.y.78 = p.y.62
temp.79 = p.y.62
temp.80 = int 1
temp.81 = p.y.62 + temp.80
p.y.82 = temp.81
temp.83 = i.53
temp.84 = int 1
temp.85 = i.53 + temp.84
i.86 = temp.85
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
temp.46 = int 1
temp.51 = int 0
jmp 0

---- block 0 ----
i.53 = φ(temp.51 from 2, i.86 from 5)
sum.57 = φ(temp.43 from 2, sum.70 from 5)
p.x.60 = φ(temp.45 from 2, p.x.76 from 5)
p.y.62 = φ(temp.46 from 2, p.y.82 from 5)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
jmp 1

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.80 = int 1
temp.81 = p.y.62 + temp.80
p.y.82 = temp.81
temp.84 = int 1
temp.85 = i.53 + temp.84
i.86 = temp.85
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
temp.46 = temp.45
temp.51 = temp.43
jmp 0

---- block 0 ----
i.53 = φ(temp.51 from 2, i.86 from 5)
sum.57 = φ(temp.43 from 2, sum.70 from 5)
p.x.60 = φ(temp.45 from 2, p.x.76 from 5)
p.y.62 = φ(temp.46 from 2, p.y.82 from 5)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
jmp 1

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.80 = temp.74
temp.81 = p.y.62 + temp.80
p.y.82 = temp.81
temp.84 = temp.74
temp.85 = i.53 + temp.84
i.86 = temp.85
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
temp.46 = temp.45
temp.51 = temp.43
jmp 0

---- block 0 ----
i.53 = φ(temp.51 from 2, i.86 from 5, i.86 from 4)
sum.57 = φ(temp.43 from 2, sum.70 from 5, sum.70 from 4)
p.x.60 = φ(temp.45 from 2, p.x.76 from 5, p.x.76 from 4)
p.y.62 = φ(temp.46 from 2, p.y.82 from 5, p.y.82 from 4)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
return 

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.80 = temp.74
temp.81 = p.y.62 + temp.80
p.y.82 = temp.81
temp.84 = temp.74
temp.85 = i.53 + temp.84
i.86 = temp.85
jmp 0


----------- unreferenced_blocks_in_phi -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
temp.46 = temp.45
temp.51 = temp.43
jmp 0

---- block 0 ----
i.53 = φ(temp.51 from 2, i.86 from 4)
sum.57 = φ(temp.43 from 2, sum.70 from 4)
p.x.60 = φ(temp.45 from 2, p.x.76 from 4)
p.y.62 = φ(temp.46 from 2, p.y.82 from 4)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
return 

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.80 = temp.74
temp.81 = p.y.62 + temp.80
p.y.82 = temp.81
temp.84 = temp.74
temp.85 = i.53 + temp.84
i.86 = temp.85
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
temp.46 = temp.45
temp.51 = temp.43
jmp 0

---- block 0 ----
i.53 = φ(temp.43 from 2, i.86 from 4)
sum.57 = φ(temp.43 from 2, sum.70 from 4)
p.x.60 = φ(temp.45 from 2, p.x.76 from 4)
p.y.62 = φ(temp.45 from 2, p.y.82 from 4)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
return 

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.80 = temp.74
temp.81 = p.y.62 + temp.74
p.y.82 = temp.81
temp.84 = temp.74
temp.85 = i.53 + temp.74
i.86 = temp.85
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.43 = int 0
temp.45 = int 1
jmp 0

---- block 0 ----
i.53 = φ(temp.43 from 2, i.86 from 4)
sum.57 = φ(temp.43 from 2, sum.70 from 4)
p.x.60 = φ(temp.45 from 2, p.x.76 from 4)
p.y.62 = φ(temp.45 from 2, p.y.82 from 4)
temp.55 = int 5
temp.56 = i.53 >= temp.55
conditional_jump temp.56 3 4

---- block 3 ----
storeprop sum.57, 0
return 

---- block 4 ----
temp.65 = sum.57 + p.x.60
temp.69 = temp.65 + p.y.62
sum.70 = temp.69
temp.74 = int 1
temp.75 = p.x.60 + temp.74
p.x.76 = temp.75
temp.81 = p.y.62 + temp.74
p.y.82 = temp.81
temp.85 = i.53 + temp.74
i.86 = temp.85
jmp 0
