---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_in_loop.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
sum.45 = temp.44
temp.46 = int 1
temp.47 = int 1
temp.5.x.48 = temp.46
temp.5.y.49 = temp.47
p.x.50 = temp.5.x.48
p.y.51 = temp.5.y.49
temp.52 = int 0
i.53 = temp.52
jmp 0

---- block 0 ----
i.54 = φ(i.53 from 2, i.88 from 5)
sum.58 = φ(sum.45 from 2, sum.72 from 5)
p.x.62 = φ(p.x.50 from 2, p.x.78 from 5)
p.y.64 = φ(p.y.51 from 2, p.y.84 from 5)
temp.55 = i.54
temp.56 = int 5
temp.57 = temp.55 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
jmp 1

---- block 4 ----
jmp 5

---- block 1 ----
temp.59 = sum.58
temp.60 = temp.59
storeprop temp.60, 0
return 

---- block 5 ----
temp.61 = sum.58
temp.21.x.63 = p.x.62
temp.21.y.65 = p.y.64
temp.66 = temp.21.x.63
temp.67 = temp.61 + temp.66
temp.24.x.68 = p.x.62
temp.24.y.69 = p.y.64
temp.70 = temp.24.y.69
temp.71 = temp.67 + temp.70
sum.72 = temp.71
temp.30.x.73 = p.x.62
temp.30.y.74 = p.y.64
temp.75 = temp.30.x.73
temp.76 = int 1
temp.77 = temp.75 + temp.76
p.x.78 = temp.77
temp.36.x.79 = p.x.78
temp.36.y.80 = p.y.64
temp.81 = temp.36.y.80
temp.82 = int 1
temp.83 = temp.81 + temp.82
p.y.84 = temp.83
temp.85 = i.54
temp.86 = int 1
temp.87 = temp.85 + temp.86
i.88 = temp.87
jmp 0


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
sum.45 = temp.44
temp.46 = int 1
temp.47 = int 1
temp.5.x.48 = temp.46
temp.5.y.49 = temp.47
p.x.50 = temp.5.x.48
p.y.51 = temp.5.y.49
temp.52 = int 0
i.53 = temp.52
jmp 0

---- block 0 ----
i.54 = φ(i.53 from 2, i.88 from 5)
sum.58 = φ(sum.45 from 2, sum.72 from 5)
p.x.62 = φ(p.x.50 from 2, p.x.78 from 5)
p.y.64 = φ(p.y.51 from 2, p.y.84 from 5)
temp.55 = i.54
temp.56 = int 5
temp.57 = temp.55 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
temp.59 = sum.58
temp.60 = temp.59
storeprop temp.60, 0
jmp 1

---- block 4 ----
temp.61 = sum.58
temp.21.x.63 = p.x.62
temp.21.y.65 = p.y.64
temp.66 = temp.21.x.63
temp.67 = temp.61 + temp.66
temp.24.x.68 = p.x.62
temp.24.y.69 = p.y.64
temp.70 = temp.24.y.69
temp.71 = temp.67 + temp.70
sum.72 = temp.71
temp.30.x.73 = p.x.62
temp.30.y.74 = p.y.64
temp.75 = temp.30.x.73
temp.76 = int 1
temp.77 = temp.75 + temp.76
p.x.78 = temp.77
temp.36.x.79 = p.x.78
temp.36.y.80 = p.y.64
temp.81 = temp.36.y.80
temp.82 = int 1
temp.83 = temp.81 + temp.82
p.y.84 = temp.83
temp.85 = i.54
temp.86 = int 1
temp.87 = temp.85 + temp.86
i.88 = temp.87
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
sum.45 = temp.44
temp.46 = int 1
temp.47 = int 1
temp.5.x.48 = temp.46
temp.5.y.49 = temp.47
p.x.50 = temp.46
p.y.51 = temp.47
temp.52 = int 0
i.53 = temp.52
jmp 0

---- block 0 ----
i.54 = φ(temp.52 from 2, i.88 from 5)
sum.58 = φ(temp.44 from 2, sum.72 from 5)
p.x.62 = φ(temp.46 from 2, p.x.78 from 5)
p.y.64 = φ(temp.47 from 2, p.y.84 from 5)
temp.55 = i.54
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
temp.59 = sum.58
temp.60 = sum.58
storeprop sum.58, 0
jmp 1

---- block 4 ----
temp.61 = sum.58
temp.21.x.63 = p.x.62
temp.21.y.65 = p.y.64
temp.66 = p.x.62
temp.67 = sum.58 + p.x.62
temp.24.x.68 = p.x.62
temp.24.y.69 = p.y.64
temp.70 = p.y.64
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.30.x.73 = p.x.62
temp.30.y.74 = p.y.64
temp.75 = p.x.62
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.36.x.79 = temp.77
temp.36.y.80 = p.y.64
temp.81 = p.y.64
temp.82 = int 1
temp.83 = p.y.64 + temp.82
p.y.84 = temp.83
temp.85 = i.54
temp.86 = int 1
temp.87 = i.54 + temp.86
i.88 = temp.87
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
temp.47 = int 1
temp.52 = int 0
jmp 0

---- block 0 ----
i.54 = φ(temp.52 from 2, i.88 from 5)
sum.58 = φ(temp.44 from 2, sum.72 from 5)
p.x.62 = φ(temp.46 from 2, p.x.78 from 5)
p.y.64 = φ(temp.47 from 2, p.y.84 from 5)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
jmp 1

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.82 = int 1
temp.83 = p.y.64 + temp.82
p.y.84 = temp.83
temp.86 = int 1
temp.87 = i.54 + temp.86
i.88 = temp.87
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
temp.47 = temp.46
temp.52 = temp.44
jmp 0

---- block 0 ----
i.54 = φ(temp.52 from 2, i.88 from 5)
sum.58 = φ(temp.44 from 2, sum.72 from 5)
p.x.62 = φ(temp.46 from 2, p.x.78 from 5)
p.y.64 = φ(temp.47 from 2, p.y.84 from 5)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
jmp 1

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.82 = temp.76
temp.83 = p.y.64 + temp.82
p.y.84 = temp.83
temp.86 = temp.76
temp.87 = i.54 + temp.86
i.88 = temp.87
jmp 5

---- block 1 ----
return 

---- block 5 ----
jmp 0


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
temp.47 = temp.46
temp.52 = temp.44
jmp 0

---- block 0 ----
i.54 = φ(temp.52 from 2, i.88 from 5, i.88 from 4)
sum.58 = φ(temp.44 from 2, sum.72 from 5, sum.72 from 4)
p.x.62 = φ(temp.46 from 2, p.x.78 from 5, p.x.78 from 4)
p.y.64 = φ(temp.47 from 2, p.y.84 from 5, p.y.84 from 4)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
return 

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.82 = temp.76
temp.83 = p.y.64 + temp.82
p.y.84 = temp.83
temp.86 = temp.76
temp.87 = i.54 + temp.86
i.88 = temp.87
jmp 0


----------- unreferenced_blocks_in_phi -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
temp.47 = temp.46
temp.52 = temp.44
jmp 0

---- block 0 ----
i.54 = φ(temp.52 from 2, i.88 from 4)
sum.58 = φ(temp.44 from 2, sum.72 from 4)
p.x.62 = φ(temp.46 from 2, p.x.78 from 4)
p.y.64 = φ(temp.47 from 2, p.y.84 from 4)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
return 

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.82 = temp.76
temp.83 = p.y.64 + temp.82
p.y.84 = temp.83
temp.86 = temp.76
temp.87 = i.54 + temp.86
i.88 = temp.87
jmp 0


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
temp.47 = temp.46
temp.52 = temp.44
jmp 0

---- block 0 ----
i.54 = φ(temp.44 from 2, i.88 from 4)
sum.58 = φ(temp.44 from 2, sum.72 from 4)
p.x.62 = φ(temp.46 from 2, p.x.78 from 4)
p.y.64 = φ(temp.46 from 2, p.y.84 from 4)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
return 

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.82 = temp.76
temp.83 = p.y.64 + temp.76
p.y.84 = temp.83
temp.86 = temp.76
temp.87 = i.54 + temp.76
i.88 = temp.87
jmp 0


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 2 ----
temp.44 = int 0
temp.46 = int 1
jmp 0

---- block 0 ----
i.54 = φ(temp.44 from 2, i.88 from 4)
sum.58 = φ(temp.44 from 2, sum.72 from 4)
p.x.62 = φ(temp.46 from 2, p.x.78 from 4)
p.y.64 = φ(temp.46 from 2, p.y.84 from 4)
temp.56 = int 5
temp.57 = i.54 >= temp.56
conditional_jump temp.57 3 4

---- block 3 ----
storeprop sum.58, 0
return 

---- block 4 ----
temp.67 = sum.58 + p.x.62
temp.71 = temp.67 + p.y.64
sum.72 = temp.71
temp.76 = int 1
temp.77 = p.x.62 + temp.76
p.x.78 = temp.77
temp.83 = p.y.64 + temp.76
p.y.84 = temp.83
temp.87 = i.54 + temp.76
i.88 = temp.87
jmp 0
