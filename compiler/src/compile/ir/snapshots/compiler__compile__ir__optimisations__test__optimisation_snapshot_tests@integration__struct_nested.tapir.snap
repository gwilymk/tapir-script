---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_nested.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = int 0
temp.15.x.171 = temp.169
temp.15.y.172 = temp.170
temp.14.x.173 = temp.15.x.171
temp.14.y.174 = temp.15.y.172
temp.175 = int 10
temp.176 = int 20
temp.23.x.177 = temp.175
temp.23.y.178 = temp.176
temp.22.x.179 = temp.23.x.177
temp.22.y.180 = temp.23.y.178
temp.7.origin.x.181 = temp.14.x.173
temp.7.origin.y.182 = temp.14.y.174
temp.7.size.x.183 = temp.22.x.179
temp.7.size.y.184 = temp.22.y.180
r.origin.x.185 = temp.7.origin.x.181
r.origin.y.186 = temp.7.origin.y.182
r.size.x.187 = temp.7.size.x.183
r.size.y.188 = temp.7.size.y.184
temp.37.origin.x.189 = r.origin.x.185
temp.37.origin.y.190 = r.origin.y.186
temp.37.size.x.191 = r.size.x.187
temp.37.size.y.192 = r.size.y.188
temp.193 = int 5
temp.194 = int 5
temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198 = move_rect(temp.37.origin.x.189, temp.37.origin.y.190, temp.37.size.x.191, temp.37.size.y.192, temp.193, temp.194)
moved.origin.x.199 = temp.36.origin.x.195
moved.origin.y.200 = temp.36.origin.y.196
moved.size.x.201 = temp.36.size.x.197
moved.size.y.202 = temp.36.size.y.198
temp.61.origin.x.203 = moved.origin.x.199
temp.61.origin.y.204 = moved.origin.y.200
temp.61.size.x.205 = moved.size.x.201
temp.61.size.y.206 = moved.size.y.202
temp.207 = rect_area(temp.61.origin.x.203, temp.61.origin.y.204, temp.61.size.x.205, temp.61.size.y.206)
temp.69.origin.x.208 = moved.origin.x.199
temp.69.origin.y.209 = moved.origin.y.200
temp.69.size.x.210 = moved.size.x.201
temp.69.size.y.211 = moved.size.y.202
temp.68.x.212 = temp.69.origin.x.208
temp.68.y.213 = temp.69.origin.y.209
temp.214 = temp.68.x.212
temp.215 = temp.207 + temp.214
storeprop temp.215, 0
return 

=======================
fn rect_area(r.origin.x.79, r.origin.y.80, r.size.x.82, r.size.y.83) -> int

---- block 0 ----
temp.88.origin.x.216 = r.origin.x.79
temp.88.origin.y.217 = r.origin.y.80
temp.88.size.x.218 = r.size.x.82
temp.88.size.y.219 = r.size.y.83
temp.87.x.220 = temp.88.size.x.218
temp.87.y.221 = temp.88.size.y.219
temp.222 = temp.87.x.220
temp.98.origin.x.223 = r.origin.x.79
temp.98.origin.y.224 = r.origin.y.80
temp.98.size.x.225 = r.size.x.82
temp.98.size.y.226 = r.size.y.83
temp.97.x.227 = temp.98.size.x.225
temp.97.y.228 = temp.98.size.y.226
temp.229 = temp.97.y.228
temp.230 = temp.222 * temp.229
return temp.230

=======================
fn move_rect(r.origin.x.108, r.origin.y.109, r.size.x.111, r.size.y.112, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.129.origin.x.231 = r.origin.x.108
temp.129.origin.y.232 = r.origin.y.109
temp.129.size.x.233 = r.size.x.111
temp.129.size.y.234 = r.size.y.112
temp.128.x.235 = temp.129.origin.x.231
temp.128.y.236 = temp.129.origin.y.232
temp.237 = temp.128.x.235
temp.238 = dx.5
temp.239 = temp.237 + temp.238
temp.142.origin.x.240 = r.origin.x.108
temp.142.origin.y.241 = r.origin.y.109
temp.142.size.x.242 = r.size.x.111
temp.142.size.y.243 = r.size.y.112
temp.141.x.244 = temp.142.origin.x.240
temp.141.y.245 = temp.142.origin.y.241
temp.246 = temp.141.y.245
temp.247 = dy.6
temp.248 = temp.246 + temp.247
temp.122.x.249 = temp.239
temp.122.y.250 = temp.248
temp.121.x.251 = temp.122.x.249
temp.121.y.252 = temp.122.y.250
temp.154.origin.x.253 = r.origin.x.108
temp.154.origin.y.254 = r.origin.y.109
temp.154.size.x.255 = r.size.x.111
temp.154.size.y.256 = r.size.y.112
temp.153.x.257 = temp.154.size.x.255
temp.153.y.258 = temp.154.size.y.256
temp.114.origin.x.259 = temp.121.x.251
temp.114.origin.y.260 = temp.121.y.252
temp.114.size.x.261 = temp.153.x.257
temp.114.size.y.262 = temp.153.y.258
temp.113.origin.x.263 = temp.114.origin.x.259
temp.113.origin.y.264 = temp.114.origin.y.260
temp.113.size.x.265 = temp.114.size.x.261
temp.113.size.y.266 = temp.114.size.y.262
return temp.113.origin.x.263, temp.113.origin.y.264, temp.113.size.x.265, temp.113.size.y.266


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = int 0
temp.15.x.171 = temp.169
temp.15.y.172 = temp.170
temp.14.x.173 = temp.169
temp.14.y.174 = temp.170
temp.175 = int 10
temp.176 = int 20
temp.23.x.177 = temp.175
temp.23.y.178 = temp.176
temp.22.x.179 = temp.175
temp.22.y.180 = temp.176
temp.7.origin.x.181 = temp.169
temp.7.origin.y.182 = temp.170
temp.7.size.x.183 = temp.175
temp.7.size.y.184 = temp.176
r.origin.x.185 = temp.169
r.origin.y.186 = temp.170
r.size.x.187 = temp.175
r.size.y.188 = temp.176
temp.37.origin.x.189 = temp.169
temp.37.origin.y.190 = temp.170
temp.37.size.x.191 = temp.175
temp.37.size.y.192 = temp.176
temp.193 = int 5
temp.194 = int 5
temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198 = move_rect(temp.169, temp.170, temp.175, temp.176, temp.193, temp.194)
moved.origin.x.199 = temp.36.origin.x.195
moved.origin.y.200 = temp.36.origin.y.196
moved.size.x.201 = temp.36.size.x.197
moved.size.y.202 = temp.36.size.y.198
temp.61.origin.x.203 = temp.36.origin.x.195
temp.61.origin.y.204 = temp.36.origin.y.196
temp.61.size.x.205 = temp.36.size.x.197
temp.61.size.y.206 = temp.36.size.y.198
temp.207 = rect_area(temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198)
temp.69.origin.x.208 = temp.36.origin.x.195
temp.69.origin.y.209 = temp.36.origin.y.196
temp.69.size.x.210 = temp.36.size.x.197
temp.69.size.y.211 = temp.36.size.y.198
temp.68.x.212 = temp.36.origin.x.195
temp.68.y.213 = temp.36.origin.y.196
temp.214 = temp.36.origin.x.195
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 

=======================
fn rect_area(r.origin.x.79, r.origin.y.80, r.size.x.82, r.size.y.83) -> int

---- block 0 ----
temp.88.origin.x.216 = r.origin.x.79
temp.88.origin.y.217 = r.origin.y.80
temp.88.size.x.218 = r.size.x.82
temp.88.size.y.219 = r.size.y.83
temp.87.x.220 = r.size.x.82
temp.87.y.221 = r.size.y.83
temp.222 = r.size.x.82
temp.98.origin.x.223 = r.origin.x.79
temp.98.origin.y.224 = r.origin.y.80
temp.98.size.x.225 = r.size.x.82
temp.98.size.y.226 = r.size.y.83
temp.97.x.227 = r.size.x.82
temp.97.y.228 = r.size.y.83
temp.229 = r.size.y.83
temp.230 = r.size.x.82 * r.size.y.83
return temp.230

=======================
fn move_rect(r.origin.x.108, r.origin.y.109, r.size.x.111, r.size.y.112, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.129.origin.x.231 = r.origin.x.108
temp.129.origin.y.232 = r.origin.y.109
temp.129.size.x.233 = r.size.x.111
temp.129.size.y.234 = r.size.y.112
temp.128.x.235 = r.origin.x.108
temp.128.y.236 = r.origin.y.109
temp.237 = r.origin.x.108
temp.238 = dx.5
temp.239 = r.origin.x.108 + dx.5
temp.142.origin.x.240 = r.origin.x.108
temp.142.origin.y.241 = r.origin.y.109
temp.142.size.x.242 = r.size.x.111
temp.142.size.y.243 = r.size.y.112
temp.141.x.244 = r.origin.x.108
temp.141.y.245 = r.origin.y.109
temp.246 = r.origin.y.109
temp.247 = dy.6
temp.248 = r.origin.y.109 + dy.6
temp.122.x.249 = temp.239
temp.122.y.250 = temp.248
temp.121.x.251 = temp.239
temp.121.y.252 = temp.248
temp.154.origin.x.253 = r.origin.x.108
temp.154.origin.y.254 = r.origin.y.109
temp.154.size.x.255 = r.size.x.111
temp.154.size.y.256 = r.size.y.112
temp.153.x.257 = r.size.x.111
temp.153.y.258 = r.size.y.112
temp.114.origin.x.259 = temp.239
temp.114.origin.y.260 = temp.248
temp.114.size.x.261 = r.size.x.111
temp.114.size.y.262 = r.size.y.112
temp.113.origin.x.263 = temp.239
temp.113.origin.y.264 = temp.248
temp.113.size.x.265 = r.size.x.111
temp.113.size.y.266 = r.size.y.112
return temp.239, temp.248, r.size.x.111, r.size.y.112


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = int 5
temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198 = move_rect(temp.169, temp.170, temp.175, temp.176, temp.193, temp.194)
temp.207 = rect_area(temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198)
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 

=======================
fn rect_area(r.origin.x.79, r.origin.y.80, r.size.x.82, r.size.y.83) -> int

---- block 0 ----
temp.230 = r.size.x.82 * r.size.y.83
return temp.230

=======================
fn move_rect(r.origin.x.108, r.origin.y.109, r.size.x.111, r.size.y.112, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.239 = r.origin.x.108 + dx.5
temp.248 = r.origin.y.109 + dy.6
return temp.239, temp.248, r.size.x.111, r.size.y.112


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198 = move_rect(temp.169, temp.170, temp.175, temp.176, temp.193, temp.194)
temp.207 = rect_area(temp.36.origin.x.195, temp.36.origin.y.196, temp.36.size.x.197, temp.36.size.y.198)
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 

=======================
fn rect_area(r.origin.x.79, r.origin.y.80, r.size.x.82, r.size.y.83) -> int

---- block 0 ----
temp.230 = r.size.x.82 * r.size.y.83
return temp.230

=======================
fn move_rect(r.origin.x.108, r.origin.y.109, r.size.x.111, r.size.y.112, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.239 = r.origin.x.108 + dx.5
temp.248 = r.origin.y.109 + dy.6
return temp.239, temp.248, r.size.x.111, r.size.y.112


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
jmp 6

---- block 6 ----
temp.273 = temp.169 + temp.193
temp.274 = temp.170 + temp.194
jmp 8

---- block 8 ----
temp.269 = φ(temp.273 from 6)
temp.270 = φ(temp.274 from 6)
temp.271 = φ(temp.175 from 6)
temp.272 = φ(temp.176 from 6)
temp.36.origin.x.195 = temp.269
temp.36.origin.y.196 = temp.270
temp.36.size.x.197 = temp.271
temp.36.size.y.198 = temp.272
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.268 = temp.36.size.x.197 * temp.36.size.y.198
jmp 4

---- block 4 ----
temp.267 = φ(temp.268 from 2)
temp.207 = temp.267
jmp 1

---- block 1 ----
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 

=======================
fn rect_area(r.origin.x.79, r.origin.y.80, r.size.x.82, r.size.y.83) -> int

---- block 0 ----
temp.230 = r.size.x.82 * r.size.y.83
return temp.230

=======================
fn move_rect(r.origin.x.108, r.origin.y.109, r.size.x.111, r.size.y.112, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.239 = r.origin.x.108 + dx.5
temp.248 = r.origin.y.109 + dy.6
return temp.239, temp.248, r.size.x.111, r.size.y.112


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
jmp 6

---- block 6 ----
temp.273 = temp.169 + temp.193
temp.274 = temp.170 + temp.194
jmp 8

---- block 8 ----
temp.269 = φ(temp.273 from 6)
temp.270 = φ(temp.274 from 6)
temp.271 = φ(temp.175 from 6)
temp.272 = φ(temp.176 from 6)
temp.36.origin.x.195 = temp.269
temp.36.origin.y.196 = temp.270
temp.36.size.x.197 = temp.271
temp.36.size.y.198 = temp.272
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.268 = temp.36.size.x.197 * temp.36.size.y.198
jmp 4

---- block 4 ----
temp.267 = φ(temp.268 from 2)
temp.207 = temp.267
jmp 1

---- block 1 ----
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
jmp 6

---- block 6 ----
temp.273 = temp.169 + temp.193
temp.274 = temp.170 + temp.194
jmp 8

---- block 8 ----
temp.36.origin.x.195 = temp.273
temp.36.origin.y.196 = temp.274
temp.36.size.x.197 = temp.175
temp.36.size.y.198 = temp.176
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.268 = temp.36.size.x.197 * temp.36.size.y.198
jmp 4

---- block 4 ----
temp.207 = temp.268
jmp 1

---- block 1 ----
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
temp.273 = temp.169 + temp.193
temp.274 = temp.170 + temp.194
jmp 6

---- block 6 ----
temp.36.origin.x.195 = temp.273
temp.36.origin.y.196 = temp.274
temp.36.size.x.197 = temp.175
temp.36.size.y.198 = temp.176
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = temp.36.size.x.197 * temp.36.size.y.198
jmp 2

---- block 2 ----
temp.207 = temp.268
jmp 4

---- block 4 ----
temp.215 = temp.207 + temp.36.origin.x.195
storeprop temp.215, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.170 = temp.169
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.194 = temp.193
temp.273 = temp.169 + temp.193
temp.274 = temp.169 + temp.193
jmp 6

---- block 6 ----
temp.36.origin.x.195 = temp.273
temp.36.origin.y.196 = temp.274
temp.36.size.x.197 = temp.175
temp.36.size.y.198 = temp.176
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = temp.175 * temp.176
jmp 2

---- block 2 ----
temp.207 = temp.268
jmp 4

---- block 4 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = temp.169 + temp.193
temp.274 = temp.169 + temp.193
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = temp.175 * temp.176
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = int 5
temp.274 = int 5
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = int 200
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
jmp 1

---- block 1 ----
return 


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = temp.193
temp.274 = temp.193
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = int 200
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = temp.193
temp.274 = temp.193
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.268 = int 200
jmp 4

---- block 4 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = temp.193
temp.274 = temp.193
jmp 8

---- block 8 ----
temp.268 = int 200
jmp 5

---- block 5 ----
temp.215 = temp.268 + temp.273
storeprop temp.215, 0
jmp 4

---- block 4 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.169 = int 0
temp.175 = int 10
temp.176 = int 20
temp.193 = int 5
temp.273 = temp.193
temp.274 = temp.193
jmp 8

---- block 8 ----
temp.268 = int 200
jmp 5

---- block 5 ----
temp.215 = temp.268 + temp.193
storeprop temp.215, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.193 = int 5
jmp 8

---- block 8 ----
temp.268 = int 200
jmp 5

---- block 5 ----
temp.215 = temp.268 + temp.193
storeprop temp.215, 0
jmp 4

---- block 4 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.193 = int 5
jmp 8

---- block 8 ----
temp.268 = int 200
jmp 5

---- block 5 ----
temp.215 = int 205
storeprop temp.215, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.193 = int 5
jmp 8

---- block 8 ----
temp.268 = int 200
jmp 5

---- block 5 ----
temp.215 = int 205
storeprop temp.215, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.193 = int 5
temp.268 = int 200
jmp 8

---- block 8 ----
temp.215 = int 205
storeprop temp.215, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.215 = int 205
storeprop temp.215, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.215 = int 205
storeprop temp.215, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.215 = int 205
storeprop temp.215, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.215 = int 205
storeprop temp.215, 0
return
