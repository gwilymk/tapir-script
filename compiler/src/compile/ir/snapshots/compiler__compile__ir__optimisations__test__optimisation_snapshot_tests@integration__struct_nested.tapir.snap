---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_nested.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = int 0
temp.15.x.172 = temp.170
temp.15.y.173 = temp.171
temp.14.x.174 = temp.15.x.172
temp.14.y.175 = temp.15.y.173
temp.176 = int 10
temp.177 = int 20
temp.23.x.178 = temp.176
temp.23.y.179 = temp.177
temp.22.x.180 = temp.23.x.178
temp.22.y.181 = temp.23.y.179
temp.7.origin.x.182 = temp.14.x.174
temp.7.origin.y.183 = temp.14.y.175
temp.7.size.x.184 = temp.22.x.180
temp.7.size.y.185 = temp.22.y.181
r.origin.x.186 = temp.7.origin.x.182
r.origin.y.187 = temp.7.origin.y.183
r.size.x.188 = temp.7.size.x.184
r.size.y.189 = temp.7.size.y.185
temp.37.origin.x.190 = r.origin.x.186
temp.37.origin.y.191 = r.origin.y.187
temp.37.size.x.192 = r.size.x.188
temp.37.size.y.193 = r.size.y.189
temp.194 = int 5
temp.195 = int 5
temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199 = move_rect(temp.37.origin.x.190, temp.37.origin.y.191, temp.37.size.x.192, temp.37.size.y.193, temp.194, temp.195)
moved.origin.x.200 = temp.36.origin.x.196
moved.origin.y.201 = temp.36.origin.y.197
moved.size.x.202 = temp.36.size.x.198
moved.size.y.203 = temp.36.size.y.199
temp.61.origin.x.204 = moved.origin.x.200
temp.61.origin.y.205 = moved.origin.y.201
temp.61.size.x.206 = moved.size.x.202
temp.61.size.y.207 = moved.size.y.203
temp.208 = rect_area(temp.61.origin.x.204, temp.61.origin.y.205, temp.61.size.x.206, temp.61.size.y.207)
temp.69.origin.x.209 = moved.origin.x.200
temp.69.origin.y.210 = moved.origin.y.201
temp.69.size.x.211 = moved.size.x.202
temp.69.size.y.212 = moved.size.y.203
temp.68.x.213 = temp.69.origin.x.209
temp.68.y.214 = temp.69.origin.y.210
temp.215 = temp.68.x.213
temp.216 = temp.208 + temp.215
temp.217 = temp.216
storeprop temp.217, 0
return 

=======================
fn rect_area(r.origin.x.80, r.origin.y.81, r.size.x.83, r.size.y.84) -> int

---- block 0 ----
temp.89.origin.x.218 = r.origin.x.80
temp.89.origin.y.219 = r.origin.y.81
temp.89.size.x.220 = r.size.x.83
temp.89.size.y.221 = r.size.y.84
temp.88.x.222 = temp.89.size.x.220
temp.88.y.223 = temp.89.size.y.221
temp.224 = temp.88.x.222
temp.99.origin.x.225 = r.origin.x.80
temp.99.origin.y.226 = r.origin.y.81
temp.99.size.x.227 = r.size.x.83
temp.99.size.y.228 = r.size.y.84
temp.98.x.229 = temp.99.size.x.227
temp.98.y.230 = temp.99.size.y.228
temp.231 = temp.98.y.230
temp.232 = temp.224 * temp.231
return temp.232

=======================
fn move_rect(r.origin.x.109, r.origin.y.110, r.size.x.112, r.size.y.113, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.130.origin.x.233 = r.origin.x.109
temp.130.origin.y.234 = r.origin.y.110
temp.130.size.x.235 = r.size.x.112
temp.130.size.y.236 = r.size.y.113
temp.129.x.237 = temp.130.origin.x.233
temp.129.y.238 = temp.130.origin.y.234
temp.239 = temp.129.x.237
temp.240 = dx.5
temp.241 = temp.239 + temp.240
temp.143.origin.x.242 = r.origin.x.109
temp.143.origin.y.243 = r.origin.y.110
temp.143.size.x.244 = r.size.x.112
temp.143.size.y.245 = r.size.y.113
temp.142.x.246 = temp.143.origin.x.242
temp.142.y.247 = temp.143.origin.y.243
temp.248 = temp.142.y.247
temp.249 = dy.6
temp.250 = temp.248 + temp.249
temp.123.x.251 = temp.241
temp.123.y.252 = temp.250
temp.122.x.253 = temp.123.x.251
temp.122.y.254 = temp.123.y.252
temp.155.origin.x.255 = r.origin.x.109
temp.155.origin.y.256 = r.origin.y.110
temp.155.size.x.257 = r.size.x.112
temp.155.size.y.258 = r.size.y.113
temp.154.x.259 = temp.155.size.x.257
temp.154.y.260 = temp.155.size.y.258
temp.115.origin.x.261 = temp.122.x.253
temp.115.origin.y.262 = temp.122.y.254
temp.115.size.x.263 = temp.154.x.259
temp.115.size.y.264 = temp.154.y.260
temp.114.origin.x.265 = temp.115.origin.x.261
temp.114.origin.y.266 = temp.115.origin.y.262
temp.114.size.x.267 = temp.115.size.x.263
temp.114.size.y.268 = temp.115.size.y.264
return temp.114.origin.x.265, temp.114.origin.y.266, temp.114.size.x.267, temp.114.size.y.268


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = int 0
temp.15.x.172 = temp.170
temp.15.y.173 = temp.171
temp.14.x.174 = temp.170
temp.14.y.175 = temp.171
temp.176 = int 10
temp.177 = int 20
temp.23.x.178 = temp.176
temp.23.y.179 = temp.177
temp.22.x.180 = temp.176
temp.22.y.181 = temp.177
temp.7.origin.x.182 = temp.170
temp.7.origin.y.183 = temp.171
temp.7.size.x.184 = temp.176
temp.7.size.y.185 = temp.177
r.origin.x.186 = temp.170
r.origin.y.187 = temp.171
r.size.x.188 = temp.176
r.size.y.189 = temp.177
temp.37.origin.x.190 = temp.170
temp.37.origin.y.191 = temp.171
temp.37.size.x.192 = temp.176
temp.37.size.y.193 = temp.177
temp.194 = int 5
temp.195 = int 5
temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199 = move_rect(temp.170, temp.171, temp.176, temp.177, temp.194, temp.195)
moved.origin.x.200 = temp.36.origin.x.196
moved.origin.y.201 = temp.36.origin.y.197
moved.size.x.202 = temp.36.size.x.198
moved.size.y.203 = temp.36.size.y.199
temp.61.origin.x.204 = temp.36.origin.x.196
temp.61.origin.y.205 = temp.36.origin.y.197
temp.61.size.x.206 = temp.36.size.x.198
temp.61.size.y.207 = temp.36.size.y.199
temp.208 = rect_area(temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199)
temp.69.origin.x.209 = temp.36.origin.x.196
temp.69.origin.y.210 = temp.36.origin.y.197
temp.69.size.x.211 = temp.36.size.x.198
temp.69.size.y.212 = temp.36.size.y.199
temp.68.x.213 = temp.36.origin.x.196
temp.68.y.214 = temp.36.origin.y.197
temp.215 = temp.36.origin.x.196
temp.216 = temp.208 + temp.36.origin.x.196
temp.217 = temp.216
storeprop temp.216, 0
return 

=======================
fn rect_area(r.origin.x.80, r.origin.y.81, r.size.x.83, r.size.y.84) -> int

---- block 0 ----
temp.89.origin.x.218 = r.origin.x.80
temp.89.origin.y.219 = r.origin.y.81
temp.89.size.x.220 = r.size.x.83
temp.89.size.y.221 = r.size.y.84
temp.88.x.222 = r.size.x.83
temp.88.y.223 = r.size.y.84
temp.224 = r.size.x.83
temp.99.origin.x.225 = r.origin.x.80
temp.99.origin.y.226 = r.origin.y.81
temp.99.size.x.227 = r.size.x.83
temp.99.size.y.228 = r.size.y.84
temp.98.x.229 = r.size.x.83
temp.98.y.230 = r.size.y.84
temp.231 = r.size.y.84
temp.232 = r.size.x.83 * r.size.y.84
return temp.232

=======================
fn move_rect(r.origin.x.109, r.origin.y.110, r.size.x.112, r.size.y.113, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.130.origin.x.233 = r.origin.x.109
temp.130.origin.y.234 = r.origin.y.110
temp.130.size.x.235 = r.size.x.112
temp.130.size.y.236 = r.size.y.113
temp.129.x.237 = r.origin.x.109
temp.129.y.238 = r.origin.y.110
temp.239 = r.origin.x.109
temp.240 = dx.5
temp.241 = r.origin.x.109 + dx.5
temp.143.origin.x.242 = r.origin.x.109
temp.143.origin.y.243 = r.origin.y.110
temp.143.size.x.244 = r.size.x.112
temp.143.size.y.245 = r.size.y.113
temp.142.x.246 = r.origin.x.109
temp.142.y.247 = r.origin.y.110
temp.248 = r.origin.y.110
temp.249 = dy.6
temp.250 = r.origin.y.110 + dy.6
temp.123.x.251 = temp.241
temp.123.y.252 = temp.250
temp.122.x.253 = temp.241
temp.122.y.254 = temp.250
temp.155.origin.x.255 = r.origin.x.109
temp.155.origin.y.256 = r.origin.y.110
temp.155.size.x.257 = r.size.x.112
temp.155.size.y.258 = r.size.y.113
temp.154.x.259 = r.size.x.112
temp.154.y.260 = r.size.y.113
temp.115.origin.x.261 = temp.241
temp.115.origin.y.262 = temp.250
temp.115.size.x.263 = r.size.x.112
temp.115.size.y.264 = r.size.y.113
temp.114.origin.x.265 = temp.241
temp.114.origin.y.266 = temp.250
temp.114.size.x.267 = r.size.x.112
temp.114.size.y.268 = r.size.y.113
return temp.241, temp.250, r.size.x.112, r.size.y.113


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = int 5
temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199 = move_rect(temp.170, temp.171, temp.176, temp.177, temp.194, temp.195)
temp.208 = rect_area(temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199)
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
return 

=======================
fn rect_area(r.origin.x.80, r.origin.y.81, r.size.x.83, r.size.y.84) -> int

---- block 0 ----
temp.232 = r.size.x.83 * r.size.y.84
return temp.232

=======================
fn move_rect(r.origin.x.109, r.origin.y.110, r.size.x.112, r.size.y.113, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.241 = r.origin.x.109 + dx.5
temp.250 = r.origin.y.110 + dy.6
return temp.241, temp.250, r.size.x.112, r.size.y.113


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199 = move_rect(temp.170, temp.171, temp.176, temp.177, temp.194, temp.195)
temp.208 = rect_area(temp.36.origin.x.196, temp.36.origin.y.197, temp.36.size.x.198, temp.36.size.y.199)
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
return 

=======================
fn rect_area(r.origin.x.80, r.origin.y.81, r.size.x.83, r.size.y.84) -> int

---- block 0 ----
temp.232 = r.size.x.83 * r.size.y.84
return temp.232

=======================
fn move_rect(r.origin.x.109, r.origin.y.110, r.size.x.112, r.size.y.113, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.241 = r.origin.x.109 + dx.5
temp.250 = r.origin.y.110 + dy.6
return temp.241, temp.250, r.size.x.112, r.size.y.113


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
jmp 6

---- block 6 ----
temp.275 = temp.170 + temp.194
temp.276 = temp.171 + temp.195
jmp 8

---- block 8 ----
temp.271 = φ(temp.275 from 6)
temp.272 = φ(temp.276 from 6)
temp.273 = φ(temp.176 from 6)
temp.274 = φ(temp.177 from 6)
temp.36.origin.x.196 = temp.271
temp.36.origin.y.197 = temp.272
temp.36.size.x.198 = temp.273
temp.36.size.y.199 = temp.274
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.270 = temp.36.size.x.198 * temp.36.size.y.199
jmp 4

---- block 4 ----
temp.269 = φ(temp.270 from 2)
temp.208 = temp.269
jmp 1

---- block 1 ----
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
return 

=======================
fn rect_area(r.origin.x.80, r.origin.y.81, r.size.x.83, r.size.y.84) -> int

---- block 0 ----
temp.232 = r.size.x.83 * r.size.y.84
return temp.232

=======================
fn move_rect(r.origin.x.109, r.origin.y.110, r.size.x.112, r.size.y.113, dx.5, dy.6) -> int, int, int, int

---- block 0 ----
temp.241 = r.origin.x.109 + dx.5
temp.250 = r.origin.y.110 + dy.6
return temp.241, temp.250, r.size.x.112, r.size.y.113


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
jmp 6

---- block 6 ----
temp.275 = temp.170 + temp.194
temp.276 = temp.171 + temp.195
jmp 8

---- block 8 ----
temp.271 = φ(temp.275 from 6)
temp.272 = φ(temp.276 from 6)
temp.273 = φ(temp.176 from 6)
temp.274 = φ(temp.177 from 6)
temp.36.origin.x.196 = temp.271
temp.36.origin.y.197 = temp.272
temp.36.size.x.198 = temp.273
temp.36.size.y.199 = temp.274
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.270 = temp.36.size.x.198 * temp.36.size.y.199
jmp 4

---- block 4 ----
temp.269 = φ(temp.270 from 2)
temp.208 = temp.269
jmp 1

---- block 1 ----
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
jmp 6

---- block 6 ----
temp.275 = temp.170 + temp.194
temp.276 = temp.171 + temp.195
jmp 8

---- block 8 ----
temp.36.origin.x.196 = temp.275
temp.36.origin.y.197 = temp.276
temp.36.size.x.198 = temp.176
temp.36.size.y.199 = temp.177
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.270 = temp.36.size.x.198 * temp.36.size.y.199
jmp 4

---- block 4 ----
temp.208 = temp.270
jmp 1

---- block 1 ----
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
temp.275 = temp.170 + temp.194
temp.276 = temp.171 + temp.195
jmp 6

---- block 6 ----
temp.36.origin.x.196 = temp.275
temp.36.origin.y.197 = temp.276
temp.36.size.x.198 = temp.176
temp.36.size.y.199 = temp.177
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = temp.36.size.x.198 * temp.36.size.y.199
jmp 2

---- block 2 ----
temp.208 = temp.270
jmp 4

---- block 4 ----
temp.216 = temp.208 + temp.36.origin.x.196
storeprop temp.216, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.171 = temp.170
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.195 = temp.194
temp.275 = temp.170 + temp.194
temp.276 = temp.170 + temp.194
jmp 6

---- block 6 ----
temp.36.origin.x.196 = temp.275
temp.36.origin.y.197 = temp.276
temp.36.size.x.198 = temp.176
temp.36.size.y.199 = temp.177
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = temp.176 * temp.177
jmp 2

---- block 2 ----
temp.208 = temp.270
jmp 4

---- block 4 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = temp.170 + temp.194
temp.276 = temp.170 + temp.194
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = temp.176 * temp.177
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = int 5
temp.276 = int 5
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = int 200
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
jmp 1

---- block 1 ----
return 


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = temp.194
temp.276 = temp.194
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = int 200
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = temp.194
temp.276 = temp.194
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.270 = int 200
jmp 4

---- block 4 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = temp.194
temp.276 = temp.194
jmp 8

---- block 8 ----
temp.270 = int 200
jmp 5

---- block 5 ----
temp.216 = temp.270 + temp.275
storeprop temp.216, 0
jmp 4

---- block 4 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.170 = int 0
temp.176 = int 10
temp.177 = int 20
temp.194 = int 5
temp.275 = temp.194
temp.276 = temp.194
jmp 8

---- block 8 ----
temp.270 = int 200
jmp 5

---- block 5 ----
temp.216 = temp.270 + temp.194
storeprop temp.216, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.194 = int 5
jmp 8

---- block 8 ----
temp.270 = int 200
jmp 5

---- block 5 ----
temp.216 = temp.270 + temp.194
storeprop temp.216, 0
jmp 4

---- block 4 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.194 = int 5
jmp 8

---- block 8 ----
temp.270 = int 200
jmp 5

---- block 5 ----
temp.216 = int 205
storeprop temp.216, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.194 = int 5
jmp 8

---- block 8 ----
temp.270 = int 200
jmp 5

---- block 5 ----
temp.216 = int 205
storeprop temp.216, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.194 = int 5
temp.270 = int 200
jmp 8

---- block 8 ----
temp.216 = int 205
storeprop temp.216, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.216 = int 205
storeprop temp.216, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.216 = int 205
storeprop temp.216, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.216 = int 205
storeprop temp.216, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.216 = int 205
storeprop temp.216, 0
return
