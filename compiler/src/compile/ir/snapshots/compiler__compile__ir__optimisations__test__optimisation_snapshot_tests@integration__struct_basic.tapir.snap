---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_basic.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.3.x.33 = temp.31
temp.3.y.34 = temp.32
p.x.35 = temp.3.x.33
p.y.36 = temp.3.y.34
temp.37 = p.x.35
temp.11.x.38 = temp.37
temp.39 = p.y.36
temp.11.y.40 = temp.39
temp.41 = add_coordinates(temp.11.x.38, temp.11.y.40)
storeprop temp.41, 0
return 

=======================
fn add_coordinates(p.x.16, p.y.17) -> int

---- block 0 ----
temp.42 = p.x.16
temp.21.x.43 = temp.42
temp.44 = p.y.17
temp.21.y.45 = temp.44
temp.46 = temp.21.x.43
temp.47 = p.x.16
temp.26.x.48 = temp.47
temp.49 = p.y.17
temp.26.y.50 = temp.49
temp.51 = temp.26.y.50
temp.52 = temp.46 + temp.51
return temp.52


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.3.x.33 = temp.31
temp.3.y.34 = temp.32
p.x.35 = temp.31
p.y.36 = temp.32
temp.37 = temp.31
temp.11.x.38 = temp.31
temp.39 = temp.32
temp.11.y.40 = temp.32
temp.41 = add_coordinates(temp.31, temp.32)
storeprop temp.41, 0
return 

=======================
fn add_coordinates(p.x.16, p.y.17) -> int

---- block 0 ----
temp.42 = p.x.16
temp.21.x.43 = p.x.16
temp.44 = p.y.17
temp.21.y.45 = p.y.17
temp.46 = p.x.16
temp.47 = p.x.16
temp.26.x.48 = p.x.16
temp.49 = p.y.17
temp.26.y.50 = p.y.17
temp.51 = p.y.17
temp.52 = p.x.16 + p.y.17
return temp.52


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.41 = add_coordinates(temp.31, temp.32)
storeprop temp.41, 0
return 

=======================
fn add_coordinates(p.x.16, p.y.17) -> int

---- block 0 ----
temp.52 = p.x.16 + p.y.17
return temp.52


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
jmp 2

---- block 2 ----
temp.54 = temp.31 + temp.32
jmp 4

---- block 4 ----
temp.53 = φ(temp.54 from 2)
temp.41 = temp.53
jmp 1

---- block 1 ----
storeprop temp.41, 0
return 

=======================
fn add_coordinates(p.x.16, p.y.17) -> int

---- block 0 ----
temp.52 = p.x.16 + p.y.17
return temp.52


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
jmp 2

---- block 2 ----
temp.54 = temp.31 + temp.32
jmp 4

---- block 4 ----
temp.53 = φ(temp.54 from 2)
temp.41 = temp.53
jmp 1

---- block 1 ----
storeprop temp.41, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
jmp 2

---- block 2 ----
temp.54 = temp.31 + temp.32
jmp 4

---- block 4 ----
temp.41 = temp.54
jmp 1

---- block 1 ----
storeprop temp.41, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = temp.31 + temp.32
jmp 2

---- block 2 ----
temp.41 = temp.54
jmp 4

---- block 4 ----
storeprop temp.41, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = temp.31 + temp.32
jmp 2

---- block 2 ----
temp.41 = temp.54
jmp 4

---- block 4 ----
storeprop temp.54, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = temp.31 + temp.32
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.54, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = int 15
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.54, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = int 15
jmp 4

---- block 4 ----
storeprop temp.54, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.31 = int 5
temp.32 = int 10
temp.54 = int 15
storeprop temp.54, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.54 = int 15
storeprop temp.54, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.54 = int 15
storeprop temp.54, 0
return
