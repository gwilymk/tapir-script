---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_basic.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.4.x.40 = temp.38
temp.4.y.41 = temp.39
temp.42 = temp.4.x.40
temp.3.x.43 = temp.42
temp.44 = temp.4.y.41
temp.3.y.45 = temp.44
temp.46 = temp.3.x.43
p.x.47 = temp.46
temp.48 = temp.3.y.45
p.y.49 = temp.48
temp.50 = p.x.47
temp.18.x.51 = temp.50
temp.52 = p.y.49
temp.18.y.53 = temp.52
temp.54 = add_coordinates(temp.18.x.51, temp.18.y.53)
storeprop temp.54, 0
return 

=======================
fn add_coordinates(p.x.23, p.y.24) -> int

---- block 0 ----
temp.55 = p.x.23
temp.28.x.56 = temp.55
temp.57 = p.y.24
temp.28.y.58 = temp.57
temp.59 = temp.28.x.56
temp.60 = p.x.23
temp.33.x.61 = temp.60
temp.62 = p.y.24
temp.33.y.63 = temp.62
temp.64 = temp.33.y.63
temp.65 = temp.59 + temp.64
return temp.65


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.4.x.40 = temp.38
temp.4.y.41 = temp.39
temp.42 = temp.38
temp.3.x.43 = temp.38
temp.44 = temp.39
temp.3.y.45 = temp.39
temp.46 = temp.38
p.x.47 = temp.38
temp.48 = temp.39
p.y.49 = temp.39
temp.50 = temp.38
temp.18.x.51 = temp.38
temp.52 = temp.39
temp.18.y.53 = temp.39
temp.54 = add_coordinates(temp.38, temp.39)
storeprop temp.54, 0
return 

=======================
fn add_coordinates(p.x.23, p.y.24) -> int

---- block 0 ----
temp.55 = p.x.23
temp.28.x.56 = p.x.23
temp.57 = p.y.24
temp.28.y.58 = p.y.24
temp.59 = p.x.23
temp.60 = p.x.23
temp.33.x.61 = p.x.23
temp.62 = p.y.24
temp.33.y.63 = p.y.24
temp.64 = p.y.24
temp.65 = p.x.23 + p.y.24
return temp.65


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.54 = add_coordinates(temp.38, temp.39)
storeprop temp.54, 0
return 

=======================
fn add_coordinates(p.x.23, p.y.24) -> int

---- block 0 ----
temp.65 = p.x.23 + p.y.24
return temp.65


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
jmp 2

---- block 2 ----
temp.67 = temp.38 + temp.39
jmp 4

---- block 4 ----
temp.66 = φ(temp.67 from 2)
temp.54 = temp.66
jmp 1

---- block 1 ----
storeprop temp.54, 0
return 

=======================
fn add_coordinates(p.x.23, p.y.24) -> int

---- block 0 ----
temp.65 = p.x.23 + p.y.24
return temp.65


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
jmp 2

---- block 2 ----
temp.67 = temp.38 + temp.39
jmp 4

---- block 4 ----
temp.66 = φ(temp.67 from 2)
temp.54 = temp.66
jmp 1

---- block 1 ----
storeprop temp.54, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
jmp 2

---- block 2 ----
temp.67 = temp.38 + temp.39
jmp 4

---- block 4 ----
temp.54 = temp.67
jmp 1

---- block 1 ----
storeprop temp.54, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = temp.38 + temp.39
jmp 2

---- block 2 ----
temp.54 = temp.67
jmp 4

---- block 4 ----
storeprop temp.54, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = temp.38 + temp.39
jmp 2

---- block 2 ----
temp.54 = temp.67
jmp 4

---- block 4 ----
storeprop temp.67, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = temp.38 + temp.39
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.67, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = int 15
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.67, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = int 15
jmp 4

---- block 4 ----
storeprop temp.67, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.38 = int 5
temp.39 = int 10
temp.67 = int 15
storeprop temp.67, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.67 = int 15
storeprop temp.67, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.67 = int 15
storeprop temp.67, 0
return
