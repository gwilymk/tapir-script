---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_basic.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.3.x.27 = temp.25
temp.3.y.28 = temp.26
p.x.29 = temp.3.x.27
p.y.30 = temp.3.y.28
temp.11.x.31 = p.x.29
temp.11.y.32 = p.y.30
temp.33 = add_coordinates(temp.11.x.31, temp.11.y.32)
storeprop temp.33, 0
return 

=======================
fn add_coordinates(p.x.14, p.y.15) -> int

---- block 0 ----
temp.19.x.34 = p.x.14
temp.19.y.35 = p.y.15
temp.36 = temp.19.x.34
temp.22.x.37 = p.x.14
temp.22.y.38 = p.y.15
temp.39 = temp.22.y.38
temp.40 = temp.36 + temp.39
return temp.40


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.3.x.27 = temp.25
temp.3.y.28 = temp.26
p.x.29 = temp.25
p.y.30 = temp.26
temp.11.x.31 = temp.25
temp.11.y.32 = temp.26
temp.33 = add_coordinates(temp.25, temp.26)
storeprop temp.33, 0
return 

=======================
fn add_coordinates(p.x.14, p.y.15) -> int

---- block 0 ----
temp.19.x.34 = p.x.14
temp.19.y.35 = p.y.15
temp.36 = p.x.14
temp.22.x.37 = p.x.14
temp.22.y.38 = p.y.15
temp.39 = p.y.15
temp.40 = p.x.14 + p.y.15
return temp.40


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.33 = add_coordinates(temp.25, temp.26)
storeprop temp.33, 0
return 

=======================
fn add_coordinates(p.x.14, p.y.15) -> int

---- block 0 ----
temp.40 = p.x.14 + p.y.15
return temp.40


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
jmp 2

---- block 2 ----
temp.42 = temp.25 + temp.26
jmp 4

---- block 4 ----
temp.41 = φ(temp.42 from 2)
temp.33 = temp.41
jmp 1

---- block 1 ----
storeprop temp.33, 0
return 

=======================
fn add_coordinates(p.x.14, p.y.15) -> int

---- block 0 ----
temp.40 = p.x.14 + p.y.15
return temp.40


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
jmp 2

---- block 2 ----
temp.42 = temp.25 + temp.26
jmp 4

---- block 4 ----
temp.41 = φ(temp.42 from 2)
temp.33 = temp.41
jmp 1

---- block 1 ----
storeprop temp.33, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
jmp 2

---- block 2 ----
temp.42 = temp.25 + temp.26
jmp 4

---- block 4 ----
temp.33 = temp.42
jmp 1

---- block 1 ----
storeprop temp.33, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = temp.25 + temp.26
jmp 2

---- block 2 ----
temp.33 = temp.42
jmp 4

---- block 4 ----
storeprop temp.33, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = temp.25 + temp.26
jmp 2

---- block 2 ----
temp.33 = temp.42
jmp 4

---- block 4 ----
storeprop temp.42, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = temp.25 + temp.26
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.42, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = int 15
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
storeprop temp.42, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = int 15
jmp 4

---- block 4 ----
storeprop temp.42, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.25 = int 5
temp.26 = int 10
temp.42 = int 15
storeprop temp.42, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.42 = int 15
storeprop temp.42, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.42 = int 15
storeprop temp.42, 0
return
