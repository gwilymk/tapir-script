---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/constant_folding/strength_reduction.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.24 = int 5
v.25 = temp.24
temp.26 = v.25
temp.27 = multiply_power_of_two(temp.26)
temp.28 = v.25
temp.29 = multiply_power_of_two_lhs(temp.28)
temp.30 = temp.27 + temp.29
temp.31 = v.25
temp.32 = divide_power_of_two(temp.31)
temp.33 = temp.30 + temp.32
temp.34 = temp.33
storeprop temp.34, 0
return 

=======================
fn multiply_power_of_two(x.2) -> int

---- block 0 ----
temp.35 = x.2
temp.36 = int 8
temp.37 = temp.35 * temp.36
return temp.37

=======================
fn multiply_power_of_two_lhs(x.3) -> int

---- block 0 ----
temp.38 = int 4
temp.39 = x.3
temp.40 = temp.38 * temp.39
return temp.40

=======================
fn divide_power_of_two(x.4) -> int

---- block 0 ----
temp.41 = x.4
temp.42 = int 4
temp.43 = temp.41 / temp.42
return temp.43


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.24 = int 5
v.25 = temp.24
temp.26 = temp.24
temp.27 = multiply_power_of_two(temp.24)
temp.28 = temp.24
temp.29 = multiply_power_of_two_lhs(temp.24)
temp.30 = temp.27 + temp.29
temp.31 = temp.24
temp.32 = divide_power_of_two(temp.24)
temp.33 = temp.30 + temp.32
temp.34 = temp.33
storeprop temp.33, 0
return 

=======================
fn multiply_power_of_two(x.2) -> int

---- block 0 ----
temp.35 = x.2
temp.36 = int 8
temp.37 = x.2 * temp.36
return temp.37

=======================
fn multiply_power_of_two_lhs(x.3) -> int

---- block 0 ----
temp.38 = int 4
temp.39 = x.3
temp.40 = temp.38 * x.3
return temp.40

=======================
fn divide_power_of_two(x.4) -> int

---- block 0 ----
temp.41 = x.4
temp.42 = int 4
temp.43 = x.4 / temp.42
return temp.43


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.24 = int 5
temp.27 = multiply_power_of_two(temp.24)
temp.29 = multiply_power_of_two_lhs(temp.24)
temp.30 = temp.27 + temp.29
temp.32 = divide_power_of_two(temp.24)
temp.33 = temp.30 + temp.32
storeprop temp.33, 0
return 

=======================
fn multiply_power_of_two(x.2) -> int

---- block 0 ----
temp.36 = int 8
temp.37 = x.2 * temp.36
return temp.37

=======================
fn multiply_power_of_two_lhs(x.3) -> int

---- block 0 ----
temp.38 = int 4
temp.40 = temp.38 * x.3
return temp.40

=======================
fn divide_power_of_two(x.4) -> int

---- block 0 ----
temp.42 = int 4
temp.43 = x.4 / temp.42
return temp.43


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.24 = int 5
temp.27 = multiply_power_of_two(temp.24)
temp.29 = multiply_power_of_two_lhs(temp.24)
temp.30 = temp.27 + temp.29
temp.32 = divide_power_of_two(temp.24)
temp.33 = temp.30 + temp.32
storeprop temp.33, 0
return 

=======================
fn multiply_power_of_two(x.2) -> int

---- block 0 ----
temp.36 = int 8
temp.44 = int 3
temp.37 = x.2 << temp.44
return temp.37

=======================
fn multiply_power_of_two_lhs(x.3) -> int

---- block 0 ----
temp.38 = int 4
temp.45 = int 2
temp.40 = x.3 << temp.45
return temp.40

=======================
fn divide_power_of_two(x.4) -> int

---- block 0 ----
temp.42 = int 4
temp.46 = int 2
temp.43 = x.4 >> temp.46
return temp.43


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.24 = int 5
temp.27 = multiply_power_of_two(temp.24)
temp.29 = multiply_power_of_two_lhs(temp.24)
temp.30 = temp.27 + temp.29
temp.32 = divide_power_of_two(temp.24)
temp.33 = temp.30 + temp.32
storeprop temp.33, 0
return 

=======================
fn multiply_power_of_two(x.2) -> int

---- block 0 ----
temp.44 = int 3
temp.37 = x.2 << temp.44
return temp.37

=======================
fn multiply_power_of_two_lhs(x.3) -> int

---- block 0 ----
temp.45 = int 2
temp.40 = x.3 << temp.45
return temp.40

=======================
fn divide_power_of_two(x.4) -> int

---- block 0 ----
temp.46 = int 2
temp.43 = x.4 >> temp.46
return temp.43
