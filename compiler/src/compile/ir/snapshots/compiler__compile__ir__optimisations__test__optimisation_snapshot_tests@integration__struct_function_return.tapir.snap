---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
temp.6.x.78, temp.6.y.79 = make_point(temp.76, temp.77)
temp.80 = temp.6.x.78
p.x.81 = temp.80
temp.82 = temp.6.y.79
p.y.83 = temp.82
temp.84 = p.x.81
temp.16.x.85 = temp.84
temp.86 = p.y.83
temp.16.y.87 = temp.86
temp.15.x.88, temp.15.y.89 = double_point(temp.16.x.85, temp.16.y.87)
temp.90 = temp.15.x.88
q.x.91 = temp.90
temp.92 = temp.15.y.89
q.y.93 = temp.92
temp.94 = q.x.91
temp.30.x.95 = temp.94
temp.96 = q.y.93
temp.30.y.97 = temp.96
temp.98 = temp.30.x.95
temp.99 = q.x.91
temp.35.x.100 = temp.99
temp.101 = q.y.93
temp.35.y.102 = temp.101
temp.103 = temp.35.y.102
temp.104 = temp.98 + temp.103
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.105 = x.3
temp.106 = y.4
temp.41.x.107 = temp.105
temp.41.y.108 = temp.106
temp.109 = temp.41.x.107
temp.40.x.110 = temp.109
temp.111 = temp.41.y.108
temp.40.y.112 = temp.111
return temp.40.x.110, temp.40.y.112

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.113 = p.x.50
temp.59.x.114 = temp.113
temp.115 = p.y.51
temp.59.y.116 = temp.115
temp.117 = temp.59.x.114
temp.118 = int 2
temp.119 = temp.117 * temp.118
temp.120 = p.x.50
temp.67.x.121 = temp.120
temp.122 = p.y.51
temp.67.y.123 = temp.122
temp.124 = temp.67.y.123
temp.125 = int 2
temp.126 = temp.124 * temp.125
temp.53.x.127 = temp.119
temp.53.y.128 = temp.126
temp.129 = temp.53.x.127
temp.52.x.130 = temp.129
temp.131 = temp.53.y.128
temp.52.y.132 = temp.131
return temp.52.x.130, temp.52.y.132


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
temp.6.x.78, temp.6.y.79 = make_point(temp.76, temp.77)
temp.80 = temp.6.x.78
p.x.81 = temp.6.x.78
temp.82 = temp.6.y.79
p.y.83 = temp.6.y.79
temp.84 = temp.6.x.78
temp.16.x.85 = temp.6.x.78
temp.86 = temp.6.y.79
temp.16.y.87 = temp.6.y.79
temp.15.x.88, temp.15.y.89 = double_point(temp.6.x.78, temp.6.y.79)
temp.90 = temp.15.x.88
q.x.91 = temp.15.x.88
temp.92 = temp.15.y.89
q.y.93 = temp.15.y.89
temp.94 = temp.15.x.88
temp.30.x.95 = temp.15.x.88
temp.96 = temp.15.y.89
temp.30.y.97 = temp.15.y.89
temp.98 = temp.15.x.88
temp.99 = temp.15.x.88
temp.35.x.100 = temp.15.x.88
temp.101 = temp.15.y.89
temp.35.y.102 = temp.15.y.89
temp.103 = temp.15.y.89
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.105 = x.3
temp.106 = y.4
temp.41.x.107 = x.3
temp.41.y.108 = y.4
temp.109 = x.3
temp.40.x.110 = x.3
temp.111 = y.4
temp.40.y.112 = y.4
return x.3, y.4

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.113 = p.x.50
temp.59.x.114 = p.x.50
temp.115 = p.y.51
temp.59.y.116 = p.y.51
temp.117 = p.x.50
temp.118 = int 2
temp.119 = p.x.50 * temp.118
temp.120 = p.x.50
temp.67.x.121 = p.x.50
temp.122 = p.y.51
temp.67.y.123 = p.y.51
temp.124 = p.y.51
temp.125 = int 2
temp.126 = p.y.51 * temp.125
temp.53.x.127 = temp.119
temp.53.y.128 = temp.126
temp.129 = temp.119
temp.52.x.130 = temp.119
temp.131 = temp.126
temp.52.y.132 = temp.126
return temp.119, temp.126


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
temp.6.x.78, temp.6.y.79 = make_point(temp.76, temp.77)
temp.15.x.88, temp.15.y.89 = double_point(temp.6.x.78, temp.6.y.79)
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.118 = int 2
temp.119 = p.x.50 * temp.118
temp.125 = int 2
temp.126 = p.y.51 * temp.125
return temp.119, temp.126


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
temp.6.x.78, temp.6.y.79 = make_point(temp.76, temp.77)
temp.15.x.88, temp.15.y.89 = double_point(temp.6.x.78, temp.6.y.79)
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.118 = int 2
temp.133 = int 1
temp.119 = p.x.50 << temp.133
temp.125 = int 2
temp.134 = int 1
temp.126 = p.y.51 << temp.134
return temp.119, temp.126


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
temp.6.x.78, temp.6.y.79 = make_point(temp.76, temp.77)
temp.15.x.88, temp.15.y.89 = double_point(temp.6.x.78, temp.6.y.79)
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.118 = int 2
temp.133 = int 1
temp.119 = p.x.50 << temp.133
temp.125 = temp.118
temp.134 = temp.133
temp.126 = p.y.51 << temp.134
return temp.119, temp.126


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.135 = φ(temp.76 from 2)
temp.136 = φ(temp.77 from 2)
temp.6.x.78 = temp.135
temp.6.y.79 = temp.136
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.6.x.78 << temp.139
temp.144 = temp.140
temp.141 = temp.139
temp.143 = temp.6.y.79 << temp.141
jmp 8

---- block 8 ----
temp.137 = φ(temp.142 from 6)
temp.138 = φ(temp.143 from 6)
temp.15.x.88 = temp.137
temp.15.y.89 = temp.138
jmp 5

---- block 5 ----
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.50, p.y.51) -> int, int

---- block 0 ----
temp.118 = int 2
temp.133 = int 1
temp.119 = p.x.50 << temp.133
temp.125 = temp.118
temp.134 = temp.133
temp.126 = p.y.51 << temp.134
return temp.119, temp.126


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.135 = φ(temp.76 from 2)
temp.136 = φ(temp.77 from 2)
temp.6.x.78 = temp.135
temp.6.y.79 = temp.136
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.6.x.78 << temp.139
temp.144 = temp.140
temp.141 = temp.139
temp.143 = temp.6.y.79 << temp.141
jmp 8

---- block 8 ----
temp.137 = φ(temp.142 from 6)
temp.138 = φ(temp.143 from 6)
temp.15.x.88 = temp.137
temp.15.y.89 = temp.138
jmp 5

---- block 5 ----
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.6.x.78 = temp.76
temp.6.y.79 = temp.77
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.6.x.78 << temp.139
temp.144 = temp.140
temp.141 = temp.139
temp.143 = temp.6.y.79 << temp.141
jmp 8

---- block 8 ----
temp.15.x.88 = temp.142
temp.15.y.89 = temp.143
jmp 5

---- block 5 ----
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
temp.6.x.78 = temp.76
temp.6.y.79 = temp.77
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.6.x.78 << temp.139
temp.144 = temp.140
temp.141 = temp.139
temp.143 = temp.6.y.79 << temp.141
jmp 6

---- block 6 ----
temp.15.x.88 = temp.142
temp.15.y.89 = temp.143
jmp 8

---- block 8 ----
temp.104 = temp.15.x.88 + temp.15.y.89
storeprop temp.104, 0
jmp 5

---- block 5 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
temp.6.x.78 = temp.76
temp.6.y.79 = temp.77
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.76 << temp.139
temp.144 = temp.140
temp.141 = temp.139
temp.143 = temp.77 << temp.139
jmp 6

---- block 6 ----
temp.15.x.88 = temp.142
temp.15.y.89 = temp.143
jmp 8

---- block 8 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = temp.76 << temp.139
temp.143 = temp.77 << temp.139
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
jmp 5

---- block 5 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = int 6
temp.143 = int 8
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = int 6
temp.143 = int 8
jmp 8

---- block 8 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 3
temp.77 = int 4
jmp 4

---- block 4 ----
temp.140 = int 2
temp.139 = int 1
temp.142 = int 6
temp.143 = int 8
jmp 1

---- block 1 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
jmp 8

---- block 8 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.142 = int 6
temp.143 = int 8
jmp 1

---- block 1 ----
temp.104 = temp.142 + temp.143
storeprop temp.104, 0
jmp 8

---- block 8 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.142 = int 6
temp.143 = int 8
jmp 1

---- block 1 ----
temp.104 = int 14
storeprop temp.104, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.142 = int 6
temp.143 = int 8
jmp 1

---- block 1 ----
temp.104 = int 14
storeprop temp.104, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.142 = int 6
temp.143 = int 8
jmp 4

---- block 4 ----
temp.104 = int 14
storeprop temp.104, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.104 = int 14
storeprop temp.104, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.104 = int 14
storeprop temp.104, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.104 = int 14
storeprop temp.104, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.104 = int 14
storeprop temp.104, 0
return
