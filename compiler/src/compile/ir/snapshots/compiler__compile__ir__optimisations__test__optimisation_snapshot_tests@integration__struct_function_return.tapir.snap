---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
temp.6.x.68, temp.6.y.69 = make_point(temp.66, temp.67)
temp.70 = temp.6.x.68
p.x.71 = temp.70
temp.72 = temp.6.y.69
p.y.73 = temp.72
temp.74 = p.x.71
temp.16.x.75 = temp.74
temp.76 = p.y.73
temp.16.y.77 = temp.76
temp.15.x.78, temp.15.y.79 = double_point(temp.16.x.75, temp.16.y.77)
temp.80 = temp.15.x.78
q.x.81 = temp.80
temp.82 = temp.15.y.79
q.y.83 = temp.82
temp.84 = q.x.81
temp.30.x.85 = temp.84
temp.86 = q.y.83
temp.30.y.87 = temp.86
temp.88 = temp.30.x.85
temp.89 = q.x.81
temp.35.x.90 = temp.89
temp.91 = q.y.83
temp.35.y.92 = temp.91
temp.93 = temp.35.y.92
temp.94 = temp.88 + temp.93
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.95 = x.3
temp.96 = y.4
temp.40.x.97 = temp.95
temp.40.y.98 = temp.96
return temp.40.x.97, temp.40.y.98

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.99 = p.x.45
temp.51.x.100 = temp.99
temp.101 = p.y.46
temp.51.y.102 = temp.101
temp.103 = temp.51.x.100
temp.104 = int 2
temp.105 = temp.103 * temp.104
temp.106 = p.x.45
temp.59.x.107 = temp.106
temp.108 = p.y.46
temp.59.y.109 = temp.108
temp.110 = temp.59.y.109
temp.111 = int 2
temp.112 = temp.110 * temp.111
temp.47.x.113 = temp.105
temp.47.y.114 = temp.112
return temp.47.x.113, temp.47.y.114


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
temp.6.x.68, temp.6.y.69 = make_point(temp.66, temp.67)
temp.70 = temp.6.x.68
p.x.71 = temp.6.x.68
temp.72 = temp.6.y.69
p.y.73 = temp.6.y.69
temp.74 = temp.6.x.68
temp.16.x.75 = temp.6.x.68
temp.76 = temp.6.y.69
temp.16.y.77 = temp.6.y.69
temp.15.x.78, temp.15.y.79 = double_point(temp.6.x.68, temp.6.y.69)
temp.80 = temp.15.x.78
q.x.81 = temp.15.x.78
temp.82 = temp.15.y.79
q.y.83 = temp.15.y.79
temp.84 = temp.15.x.78
temp.30.x.85 = temp.15.x.78
temp.86 = temp.15.y.79
temp.30.y.87 = temp.15.y.79
temp.88 = temp.15.x.78
temp.89 = temp.15.x.78
temp.35.x.90 = temp.15.x.78
temp.91 = temp.15.y.79
temp.35.y.92 = temp.15.y.79
temp.93 = temp.15.y.79
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.95 = x.3
temp.96 = y.4
temp.40.x.97 = x.3
temp.40.y.98 = y.4
return x.3, y.4

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.99 = p.x.45
temp.51.x.100 = p.x.45
temp.101 = p.y.46
temp.51.y.102 = p.y.46
temp.103 = p.x.45
temp.104 = int 2
temp.105 = p.x.45 * temp.104
temp.106 = p.x.45
temp.59.x.107 = p.x.45
temp.108 = p.y.46
temp.59.y.109 = p.y.46
temp.110 = p.y.46
temp.111 = int 2
temp.112 = p.y.46 * temp.111
temp.47.x.113 = temp.105
temp.47.y.114 = temp.112
return temp.105, temp.112


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
temp.6.x.68, temp.6.y.69 = make_point(temp.66, temp.67)
temp.15.x.78, temp.15.y.79 = double_point(temp.6.x.68, temp.6.y.69)
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.104 = int 2
temp.105 = p.x.45 * temp.104
temp.111 = int 2
temp.112 = p.y.46 * temp.111
return temp.105, temp.112


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
temp.6.x.68, temp.6.y.69 = make_point(temp.66, temp.67)
temp.15.x.78, temp.15.y.79 = double_point(temp.6.x.68, temp.6.y.69)
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.104 = int 2
temp.115 = int 1
temp.105 = p.x.45 << temp.115
temp.111 = int 2
temp.116 = int 1
temp.112 = p.y.46 << temp.116
return temp.105, temp.112


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
temp.6.x.68, temp.6.y.69 = make_point(temp.66, temp.67)
temp.15.x.78, temp.15.y.79 = double_point(temp.6.x.68, temp.6.y.69)
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.104 = int 2
temp.115 = int 1
temp.105 = p.x.45 << temp.115
temp.111 = temp.104
temp.116 = temp.115
temp.112 = p.y.46 << temp.116
return temp.105, temp.112


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.117 = φ(temp.66 from 2)
temp.118 = φ(temp.67 from 2)
temp.6.x.68 = temp.117
temp.6.y.69 = temp.118
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.6.x.68 << temp.121
temp.126 = temp.122
temp.123 = temp.121
temp.125 = temp.6.y.69 << temp.123
jmp 8

---- block 8 ----
temp.119 = φ(temp.124 from 6)
temp.120 = φ(temp.125 from 6)
temp.15.x.78 = temp.119
temp.15.y.79 = temp.120
jmp 5

---- block 5 ----
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.45, p.y.46) -> int, int

---- block 0 ----
temp.104 = int 2
temp.115 = int 1
temp.105 = p.x.45 << temp.115
temp.111 = temp.104
temp.116 = temp.115
temp.112 = p.y.46 << temp.116
return temp.105, temp.112


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.117 = φ(temp.66 from 2)
temp.118 = φ(temp.67 from 2)
temp.6.x.68 = temp.117
temp.6.y.69 = temp.118
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.6.x.68 << temp.121
temp.126 = temp.122
temp.123 = temp.121
temp.125 = temp.6.y.69 << temp.123
jmp 8

---- block 8 ----
temp.119 = φ(temp.124 from 6)
temp.120 = φ(temp.125 from 6)
temp.15.x.78 = temp.119
temp.15.y.79 = temp.120
jmp 5

---- block 5 ----
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.6.x.68 = temp.66
temp.6.y.69 = temp.67
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.6.x.68 << temp.121
temp.126 = temp.122
temp.123 = temp.121
temp.125 = temp.6.y.69 << temp.123
jmp 8

---- block 8 ----
temp.15.x.78 = temp.124
temp.15.y.79 = temp.125
jmp 5

---- block 5 ----
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
temp.6.x.68 = temp.66
temp.6.y.69 = temp.67
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.6.x.68 << temp.121
temp.126 = temp.122
temp.123 = temp.121
temp.125 = temp.6.y.69 << temp.123
jmp 6

---- block 6 ----
temp.15.x.78 = temp.124
temp.15.y.79 = temp.125
jmp 8

---- block 8 ----
temp.94 = temp.15.x.78 + temp.15.y.79
storeprop temp.94, 0
jmp 5

---- block 5 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
temp.6.x.68 = temp.66
temp.6.y.69 = temp.67
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.66 << temp.121
temp.126 = temp.122
temp.123 = temp.121
temp.125 = temp.67 << temp.121
jmp 6

---- block 6 ----
temp.15.x.78 = temp.124
temp.15.y.79 = temp.125
jmp 8

---- block 8 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = temp.66 << temp.121
temp.125 = temp.67 << temp.121
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
jmp 5

---- block 5 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = int 6
temp.125 = int 8
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = int 6
temp.125 = int 8
jmp 8

---- block 8 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.66 = int 3
temp.67 = int 4
jmp 4

---- block 4 ----
temp.122 = int 2
temp.121 = int 1
temp.124 = int 6
temp.125 = int 8
jmp 1

---- block 1 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
jmp 8

---- block 8 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.124 = int 6
temp.125 = int 8
jmp 1

---- block 1 ----
temp.94 = temp.124 + temp.125
storeprop temp.94, 0
jmp 8

---- block 8 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.124 = int 6
temp.125 = int 8
jmp 1

---- block 1 ----
temp.94 = int 14
storeprop temp.94, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.124 = int 6
temp.125 = int 8
jmp 1

---- block 1 ----
temp.94 = int 14
storeprop temp.94, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.124 = int 6
temp.125 = int 8
jmp 4

---- block 4 ----
temp.94 = int 14
storeprop temp.94, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.94 = int 14
storeprop temp.94, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.94 = int 14
storeprop temp.94, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.94 = int 14
storeprop temp.94, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.94 = int 14
storeprop temp.94, 0
return
