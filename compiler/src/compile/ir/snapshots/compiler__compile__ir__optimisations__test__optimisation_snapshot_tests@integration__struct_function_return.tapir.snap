---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
temp.6.x.61, temp.6.y.62 = make_point(temp.59, temp.60)
p.x.63 = temp.6.x.61
p.y.64 = temp.6.y.62
temp.14.x.65 = p.x.63
temp.14.y.66 = p.y.64
temp.13.x.67, temp.13.y.68 = double_point(temp.14.x.65, temp.14.y.66)
q.x.69 = temp.13.x.67
q.y.70 = temp.13.y.68
temp.24.x.71 = q.x.69
temp.24.y.72 = q.y.70
temp.73 = temp.24.x.71
temp.27.x.74 = q.x.69
temp.27.y.75 = q.y.70
temp.76 = temp.27.y.75
temp.77 = temp.73 + temp.76
temp.78 = temp.77
storeprop temp.78, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.79 = x.3
temp.80 = y.4
temp.32.x.81 = temp.79
temp.32.y.82 = temp.80
temp.31.x.83 = temp.32.x.81
temp.31.y.84 = temp.32.y.82
return temp.31.x.83, temp.31.y.84

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.48.x.85 = p.x.39
temp.48.y.86 = p.y.40
temp.87 = temp.48.x.85
temp.88 = int 2
temp.89 = temp.87 * temp.88
temp.54.x.90 = p.x.39
temp.54.y.91 = p.y.40
temp.92 = temp.54.y.91
temp.93 = int 2
temp.94 = temp.92 * temp.93
temp.42.x.95 = temp.89
temp.42.y.96 = temp.94
temp.41.x.97 = temp.42.x.95
temp.41.y.98 = temp.42.y.96
return temp.41.x.97, temp.41.y.98


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
temp.6.x.61, temp.6.y.62 = make_point(temp.59, temp.60)
p.x.63 = temp.6.x.61
p.y.64 = temp.6.y.62
temp.14.x.65 = temp.6.x.61
temp.14.y.66 = temp.6.y.62
temp.13.x.67, temp.13.y.68 = double_point(temp.6.x.61, temp.6.y.62)
q.x.69 = temp.13.x.67
q.y.70 = temp.13.y.68
temp.24.x.71 = temp.13.x.67
temp.24.y.72 = temp.13.y.68
temp.73 = temp.13.x.67
temp.27.x.74 = temp.13.x.67
temp.27.y.75 = temp.13.y.68
temp.76 = temp.13.y.68
temp.77 = temp.13.x.67 + temp.13.y.68
temp.78 = temp.77
storeprop temp.77, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.79 = x.3
temp.80 = y.4
temp.32.x.81 = x.3
temp.32.y.82 = y.4
temp.31.x.83 = x.3
temp.31.y.84 = y.4
return x.3, y.4

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.48.x.85 = p.x.39
temp.48.y.86 = p.y.40
temp.87 = p.x.39
temp.88 = int 2
temp.89 = p.x.39 * temp.88
temp.54.x.90 = p.x.39
temp.54.y.91 = p.y.40
temp.92 = p.y.40
temp.93 = int 2
temp.94 = p.y.40 * temp.93
temp.42.x.95 = temp.89
temp.42.y.96 = temp.94
temp.41.x.97 = temp.89
temp.41.y.98 = temp.94
return temp.89, temp.94


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
temp.6.x.61, temp.6.y.62 = make_point(temp.59, temp.60)
temp.13.x.67, temp.13.y.68 = double_point(temp.6.x.61, temp.6.y.62)
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.88 = int 2
temp.89 = p.x.39 * temp.88
temp.93 = int 2
temp.94 = p.y.40 * temp.93
return temp.89, temp.94


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
temp.6.x.61, temp.6.y.62 = make_point(temp.59, temp.60)
temp.13.x.67, temp.13.y.68 = double_point(temp.6.x.61, temp.6.y.62)
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.88 = int 2
temp.99 = int 1
temp.89 = p.x.39 << temp.99
temp.93 = int 2
temp.100 = int 1
temp.94 = p.y.40 << temp.100
return temp.89, temp.94


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
temp.6.x.61, temp.6.y.62 = make_point(temp.59, temp.60)
temp.13.x.67, temp.13.y.68 = double_point(temp.6.x.61, temp.6.y.62)
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.88 = int 2
temp.99 = int 1
temp.89 = p.x.39 << temp.99
temp.93 = temp.88
temp.100 = temp.99
temp.94 = p.y.40 << temp.100
return temp.89, temp.94


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.101 = φ(temp.59 from 2)
temp.102 = φ(temp.60 from 2)
temp.6.x.61 = temp.101
temp.6.y.62 = temp.102
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.6.x.61 << temp.105
temp.110 = temp.106
temp.107 = temp.105
temp.109 = temp.6.y.62 << temp.107
jmp 8

---- block 8 ----
temp.103 = φ(temp.108 from 6)
temp.104 = φ(temp.109 from 6)
temp.13.x.67 = temp.103
temp.13.y.68 = temp.104
jmp 5

---- block 5 ----
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.39, p.y.40) -> int, int

---- block 0 ----
temp.88 = int 2
temp.99 = int 1
temp.89 = p.x.39 << temp.99
temp.93 = temp.88
temp.100 = temp.99
temp.94 = p.y.40 << temp.100
return temp.89, temp.94


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.101 = φ(temp.59 from 2)
temp.102 = φ(temp.60 from 2)
temp.6.x.61 = temp.101
temp.6.y.62 = temp.102
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.6.x.61 << temp.105
temp.110 = temp.106
temp.107 = temp.105
temp.109 = temp.6.y.62 << temp.107
jmp 8

---- block 8 ----
temp.103 = φ(temp.108 from 6)
temp.104 = φ(temp.109 from 6)
temp.13.x.67 = temp.103
temp.13.y.68 = temp.104
jmp 5

---- block 5 ----
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.6.x.61 = temp.59
temp.6.y.62 = temp.60
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.6.x.61 << temp.105
temp.110 = temp.106
temp.107 = temp.105
temp.109 = temp.6.y.62 << temp.107
jmp 8

---- block 8 ----
temp.13.x.67 = temp.108
temp.13.y.68 = temp.109
jmp 5

---- block 5 ----
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
temp.6.x.61 = temp.59
temp.6.y.62 = temp.60
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.6.x.61 << temp.105
temp.110 = temp.106
temp.107 = temp.105
temp.109 = temp.6.y.62 << temp.107
jmp 6

---- block 6 ----
temp.13.x.67 = temp.108
temp.13.y.68 = temp.109
jmp 8

---- block 8 ----
temp.77 = temp.13.x.67 + temp.13.y.68
storeprop temp.77, 0
jmp 5

---- block 5 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
temp.6.x.61 = temp.59
temp.6.y.62 = temp.60
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.59 << temp.105
temp.110 = temp.106
temp.107 = temp.105
temp.109 = temp.60 << temp.105
jmp 6

---- block 6 ----
temp.13.x.67 = temp.108
temp.13.y.68 = temp.109
jmp 8

---- block 8 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = temp.59 << temp.105
temp.109 = temp.60 << temp.105
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
jmp 5

---- block 5 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = int 6
temp.109 = int 8
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = int 6
temp.109 = int 8
jmp 8

---- block 8 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.59 = int 3
temp.60 = int 4
jmp 4

---- block 4 ----
temp.106 = int 2
temp.105 = int 1
temp.108 = int 6
temp.109 = int 8
jmp 1

---- block 1 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
jmp 8

---- block 8 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.108 = int 6
temp.109 = int 8
jmp 1

---- block 1 ----
temp.77 = temp.108 + temp.109
storeprop temp.77, 0
jmp 8

---- block 8 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.108 = int 6
temp.109 = int 8
jmp 1

---- block 1 ----
temp.77 = int 14
storeprop temp.77, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.108 = int 6
temp.109 = int 8
jmp 1

---- block 1 ----
temp.77 = int 14
storeprop temp.77, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.108 = int 6
temp.109 = int 8
jmp 4

---- block 4 ----
temp.77 = int 14
storeprop temp.77, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.77 = int 14
storeprop temp.77, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.77 = int 14
storeprop temp.77, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.77 = int 14
storeprop temp.77, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.77 = int 14
storeprop temp.77, 0
return
