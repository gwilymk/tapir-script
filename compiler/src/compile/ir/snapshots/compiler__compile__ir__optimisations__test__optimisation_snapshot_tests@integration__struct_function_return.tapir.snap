---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
temp.6.x.55, temp.6.y.56 = make_point(temp.53, temp.54)
p.x.57 = temp.6.x.55
p.y.58 = temp.6.y.56
temp.14.x.59 = p.x.57
temp.14.y.60 = p.y.58
temp.13.x.61, temp.13.y.62 = double_point(temp.14.x.59, temp.14.y.60)
q.x.63 = temp.13.x.61
q.y.64 = temp.13.y.62
temp.24.x.65 = q.x.63
temp.24.y.66 = q.y.64
temp.67 = temp.24.x.65
temp.27.x.68 = q.x.63
temp.27.y.69 = q.y.64
temp.70 = temp.27.y.69
temp.71 = temp.67 + temp.70
temp.72 = temp.71
storeprop temp.72, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.73 = x.3
temp.74 = y.4
temp.31.x.75 = temp.73
temp.31.y.76 = temp.74
return temp.31.x.75, temp.31.y.76

=======================
fn double_point(p.x.36, p.y.37) -> int, int

---- block 0 ----
temp.44.x.77 = p.x.36
temp.44.y.78 = p.y.37
temp.79 = temp.44.x.77
temp.80 = int 2
temp.81 = temp.79 * temp.80
temp.50.x.82 = p.x.36
temp.50.y.83 = p.y.37
temp.84 = temp.50.y.83
temp.85 = int 2
temp.86 = temp.84 * temp.85
temp.38.x.87 = temp.81
temp.38.y.88 = temp.86
return temp.38.x.87, temp.38.y.88


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
temp.6.x.55, temp.6.y.56 = make_point(temp.53, temp.54)
p.x.57 = temp.6.x.55
p.y.58 = temp.6.y.56
temp.14.x.59 = temp.6.x.55
temp.14.y.60 = temp.6.y.56
temp.13.x.61, temp.13.y.62 = double_point(temp.6.x.55, temp.6.y.56)
q.x.63 = temp.13.x.61
q.y.64 = temp.13.y.62
temp.24.x.65 = temp.13.x.61
temp.24.y.66 = temp.13.y.62
temp.67 = temp.13.x.61
temp.27.x.68 = temp.13.x.61
temp.27.y.69 = temp.13.y.62
temp.70 = temp.13.y.62
temp.71 = temp.13.x.61 + temp.13.y.62
temp.72 = temp.71
storeprop temp.71, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.73 = x.3
temp.74 = y.4
temp.31.x.75 = x.3
temp.31.y.76 = y.4
return x.3, y.4

=======================
fn double_point(p.x.36, p.y.37) -> int, int

---- block 0 ----
temp.44.x.77 = p.x.36
temp.44.y.78 = p.y.37
temp.79 = p.x.36
temp.80 = int 2
temp.81 = p.x.36 * temp.80
temp.50.x.82 = p.x.36
temp.50.y.83 = p.y.37
temp.84 = p.y.37
temp.85 = int 2
temp.86 = p.y.37 * temp.85
temp.38.x.87 = temp.81
temp.38.y.88 = temp.86
return temp.81, temp.86


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
temp.6.x.55, temp.6.y.56 = make_point(temp.53, temp.54)
temp.13.x.61, temp.13.y.62 = double_point(temp.6.x.55, temp.6.y.56)
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.36, p.y.37) -> int, int

---- block 0 ----
temp.80 = int 2
temp.81 = p.x.36 * temp.80
temp.85 = int 2
temp.86 = p.y.37 * temp.85
return temp.81, temp.86


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
temp.6.x.55, temp.6.y.56 = make_point(temp.53, temp.54)
temp.13.x.61, temp.13.y.62 = double_point(temp.6.x.55, temp.6.y.56)
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.36, p.y.37) -> int, int

---- block 0 ----
temp.80 = int 2
temp.81 = p.x.36 * temp.80
temp.85 = temp.80
temp.86 = p.y.37 * temp.85
return temp.81, temp.86


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.95 = φ(temp.53 from 6)
temp.96 = φ(temp.54 from 6)
temp.6.x.55 = temp.95
temp.6.y.56 = temp.96
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.91 = int 2
temp.93 = temp.6.x.55 * temp.91
temp.92 = temp.91
temp.94 = temp.6.y.56 * temp.92
jmp 4

---- block 4 ----
temp.89 = φ(temp.93 from 2)
temp.90 = φ(temp.94 from 2)
temp.13.x.61 = temp.89
temp.13.y.62 = temp.90
jmp 1

---- block 1 ----
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.36, p.y.37) -> int, int

---- block 0 ----
temp.80 = int 2
temp.81 = p.x.36 * temp.80
temp.85 = temp.80
temp.86 = p.y.37 * temp.85
return temp.81, temp.86


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.95 = φ(temp.53 from 6)
temp.96 = φ(temp.54 from 6)
temp.6.x.55 = temp.95
temp.6.y.56 = temp.96
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.91 = int 2
temp.93 = temp.6.x.55 * temp.91
temp.92 = temp.91
temp.94 = temp.6.y.56 * temp.92
jmp 4

---- block 4 ----
temp.89 = φ(temp.93 from 2)
temp.90 = φ(temp.94 from 2)
temp.13.x.61 = temp.89
temp.13.y.62 = temp.90
jmp 1

---- block 1 ----
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.6.x.55 = temp.53
temp.6.y.56 = temp.54
jmp 5

---- block 5 ----
jmp 2

---- block 2 ----
temp.91 = int 2
temp.93 = temp.6.x.55 * temp.91
temp.92 = temp.91
temp.94 = temp.6.y.56 * temp.92
jmp 4

---- block 4 ----
temp.13.x.61 = temp.93
temp.13.y.62 = temp.94
jmp 1

---- block 1 ----
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
temp.6.x.55 = temp.53
temp.6.y.56 = temp.54
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.91 = int 2
temp.93 = temp.6.x.55 * temp.91
temp.92 = temp.91
temp.94 = temp.6.y.56 * temp.92
jmp 2

---- block 2 ----
temp.13.x.61 = temp.93
temp.13.y.62 = temp.94
jmp 4

---- block 4 ----
temp.71 = temp.13.x.61 + temp.13.y.62
storeprop temp.71, 0
jmp 1

---- block 1 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
temp.6.x.55 = temp.53
temp.6.y.56 = temp.54
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.91 = int 2
temp.93 = temp.53 * temp.91
temp.92 = temp.91
temp.94 = temp.54 * temp.91
jmp 2

---- block 2 ----
temp.13.x.61 = temp.93
temp.13.y.62 = temp.94
jmp 4

---- block 4 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.91 = int 2
temp.93 = temp.53 * temp.91
temp.94 = temp.54 * temp.91
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
jmp 1

---- block 1 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.91 = int 2
temp.93 = int 6
temp.94 = int 8
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 8

---- block 8 ----
jmp 5

---- block 5 ----
temp.91 = int 2
temp.93 = int 6
temp.94 = int 8
jmp 4

---- block 4 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.53 = int 3
temp.54 = int 4
jmp 8

---- block 8 ----
temp.91 = int 2
temp.93 = int 6
temp.94 = int 8
jmp 5

---- block 5 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
jmp 4

---- block 4 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.93 = int 6
temp.94 = int 8
jmp 5

---- block 5 ----
temp.71 = temp.93 + temp.94
storeprop temp.71, 0
jmp 4

---- block 4 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.93 = int 6
temp.94 = int 8
jmp 5

---- block 5 ----
temp.71 = int 14
storeprop temp.71, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.93 = int 6
temp.94 = int 8
jmp 5

---- block 5 ----
temp.71 = int 14
storeprop temp.71, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.93 = int 6
temp.94 = int 8
jmp 8

---- block 8 ----
temp.71 = int 14
storeprop temp.71, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.71 = int 14
storeprop temp.71, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 8

---- block 8 ----
temp.71 = int 14
storeprop temp.71, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.71 = int 14
storeprop temp.71, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.71 = int 14
storeprop temp.71, 0
return
