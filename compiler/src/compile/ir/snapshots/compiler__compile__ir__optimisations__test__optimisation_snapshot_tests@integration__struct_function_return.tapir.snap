---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
temp.6.x.74, temp.6.y.75 = make_point(temp.72, temp.73)
temp.76 = temp.6.x.74
p.x.77 = temp.76
temp.78 = temp.6.y.75
p.y.79 = temp.78
temp.80 = p.x.77
temp.16.x.81 = temp.80
temp.82 = p.y.79
temp.16.y.83 = temp.82
temp.15.x.84, temp.15.y.85 = double_point(temp.16.x.81, temp.16.y.83)
temp.86 = temp.15.x.84
q.x.87 = temp.86
temp.88 = temp.15.y.85
q.y.89 = temp.88
temp.90 = q.x.87
temp.30.x.91 = temp.90
temp.92 = q.y.89
temp.30.y.93 = temp.92
temp.94 = temp.30.x.91
temp.95 = q.x.87
temp.35.x.96 = temp.95
temp.97 = q.y.89
temp.35.y.98 = temp.97
temp.99 = temp.35.y.98
temp.100 = temp.94 + temp.99
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.101 = x.3
temp.102 = y.4
temp.41.x.103 = temp.101
temp.41.y.104 = temp.102
temp.40.x.105 = temp.41.x.103
temp.40.y.106 = temp.41.y.104
return temp.40.x.105, temp.40.y.106

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.107 = p.x.48
temp.57.x.108 = temp.107
temp.109 = p.y.49
temp.57.y.110 = temp.109
temp.111 = temp.57.x.108
temp.112 = int 2
temp.113 = temp.111 * temp.112
temp.114 = p.x.48
temp.65.x.115 = temp.114
temp.116 = p.y.49
temp.65.y.117 = temp.116
temp.118 = temp.65.y.117
temp.119 = int 2
temp.120 = temp.118 * temp.119
temp.51.x.121 = temp.113
temp.51.y.122 = temp.120
temp.50.x.123 = temp.51.x.121
temp.50.y.124 = temp.51.y.122
return temp.50.x.123, temp.50.y.124


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
temp.6.x.74, temp.6.y.75 = make_point(temp.72, temp.73)
temp.76 = temp.6.x.74
p.x.77 = temp.6.x.74
temp.78 = temp.6.y.75
p.y.79 = temp.6.y.75
temp.80 = temp.6.x.74
temp.16.x.81 = temp.6.x.74
temp.82 = temp.6.y.75
temp.16.y.83 = temp.6.y.75
temp.15.x.84, temp.15.y.85 = double_point(temp.6.x.74, temp.6.y.75)
temp.86 = temp.15.x.84
q.x.87 = temp.15.x.84
temp.88 = temp.15.y.85
q.y.89 = temp.15.y.85
temp.90 = temp.15.x.84
temp.30.x.91 = temp.15.x.84
temp.92 = temp.15.y.85
temp.30.y.93 = temp.15.y.85
temp.94 = temp.15.x.84
temp.95 = temp.15.x.84
temp.35.x.96 = temp.15.x.84
temp.97 = temp.15.y.85
temp.35.y.98 = temp.15.y.85
temp.99 = temp.15.y.85
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.101 = x.3
temp.102 = y.4
temp.41.x.103 = x.3
temp.41.y.104 = y.4
temp.40.x.105 = x.3
temp.40.y.106 = y.4
return x.3, y.4

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.107 = p.x.48
temp.57.x.108 = p.x.48
temp.109 = p.y.49
temp.57.y.110 = p.y.49
temp.111 = p.x.48
temp.112 = int 2
temp.113 = p.x.48 * temp.112
temp.114 = p.x.48
temp.65.x.115 = p.x.48
temp.116 = p.y.49
temp.65.y.117 = p.y.49
temp.118 = p.y.49
temp.119 = int 2
temp.120 = p.y.49 * temp.119
temp.51.x.121 = temp.113
temp.51.y.122 = temp.120
temp.50.x.123 = temp.113
temp.50.y.124 = temp.120
return temp.113, temp.120


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
temp.6.x.74, temp.6.y.75 = make_point(temp.72, temp.73)
temp.15.x.84, temp.15.y.85 = double_point(temp.6.x.74, temp.6.y.75)
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.112 = int 2
temp.113 = p.x.48 * temp.112
temp.119 = int 2
temp.120 = p.y.49 * temp.119
return temp.113, temp.120


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
temp.6.x.74, temp.6.y.75 = make_point(temp.72, temp.73)
temp.15.x.84, temp.15.y.85 = double_point(temp.6.x.74, temp.6.y.75)
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.112 = int 2
temp.125 = int 1
temp.113 = p.x.48 << temp.125
temp.119 = int 2
temp.126 = int 1
temp.120 = p.y.49 << temp.126
return temp.113, temp.120


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
temp.6.x.74, temp.6.y.75 = make_point(temp.72, temp.73)
temp.15.x.84, temp.15.y.85 = double_point(temp.6.x.74, temp.6.y.75)
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.112 = int 2
temp.125 = int 1
temp.113 = p.x.48 << temp.125
temp.119 = temp.112
temp.126 = temp.125
temp.120 = p.y.49 << temp.126
return temp.113, temp.120


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.127 = φ(temp.72 from 2)
temp.128 = φ(temp.73 from 2)
temp.6.x.74 = temp.127
temp.6.y.75 = temp.128
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.6.x.74 << temp.131
temp.136 = temp.132
temp.133 = temp.131
temp.135 = temp.6.y.75 << temp.133
jmp 8

---- block 8 ----
temp.129 = φ(temp.134 from 6)
temp.130 = φ(temp.135 from 6)
temp.15.x.84 = temp.129
temp.15.y.85 = temp.130
jmp 5

---- block 5 ----
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.48, p.y.49) -> int, int

---- block 0 ----
temp.112 = int 2
temp.125 = int 1
temp.113 = p.x.48 << temp.125
temp.119 = temp.112
temp.126 = temp.125
temp.120 = p.y.49 << temp.126
return temp.113, temp.120


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.127 = φ(temp.72 from 2)
temp.128 = φ(temp.73 from 2)
temp.6.x.74 = temp.127
temp.6.y.75 = temp.128
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.6.x.74 << temp.131
temp.136 = temp.132
temp.133 = temp.131
temp.135 = temp.6.y.75 << temp.133
jmp 8

---- block 8 ----
temp.129 = φ(temp.134 from 6)
temp.130 = φ(temp.135 from 6)
temp.15.x.84 = temp.129
temp.15.y.85 = temp.130
jmp 5

---- block 5 ----
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.6.x.74 = temp.72
temp.6.y.75 = temp.73
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.6.x.74 << temp.131
temp.136 = temp.132
temp.133 = temp.131
temp.135 = temp.6.y.75 << temp.133
jmp 8

---- block 8 ----
temp.15.x.84 = temp.134
temp.15.y.85 = temp.135
jmp 5

---- block 5 ----
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
temp.6.x.74 = temp.72
temp.6.y.75 = temp.73
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.6.x.74 << temp.131
temp.136 = temp.132
temp.133 = temp.131
temp.135 = temp.6.y.75 << temp.133
jmp 6

---- block 6 ----
temp.15.x.84 = temp.134
temp.15.y.85 = temp.135
jmp 8

---- block 8 ----
temp.100 = temp.15.x.84 + temp.15.y.85
storeprop temp.100, 0
jmp 5

---- block 5 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
temp.6.x.74 = temp.72
temp.6.y.75 = temp.73
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.72 << temp.131
temp.136 = temp.132
temp.133 = temp.131
temp.135 = temp.73 << temp.131
jmp 6

---- block 6 ----
temp.15.x.84 = temp.134
temp.15.y.85 = temp.135
jmp 8

---- block 8 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = temp.72 << temp.131
temp.135 = temp.73 << temp.131
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
jmp 5

---- block 5 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = int 6
temp.135 = int 8
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = int 6
temp.135 = int 8
jmp 8

---- block 8 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.72 = int 3
temp.73 = int 4
jmp 4

---- block 4 ----
temp.132 = int 2
temp.131 = int 1
temp.134 = int 6
temp.135 = int 8
jmp 1

---- block 1 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
jmp 8

---- block 8 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.134 = int 6
temp.135 = int 8
jmp 1

---- block 1 ----
temp.100 = temp.134 + temp.135
storeprop temp.100, 0
jmp 8

---- block 8 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.134 = int 6
temp.135 = int 8
jmp 1

---- block 1 ----
temp.100 = int 14
storeprop temp.100, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.134 = int 6
temp.135 = int 8
jmp 1

---- block 1 ----
temp.100 = int 14
storeprop temp.100, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.134 = int 6
temp.135 = int 8
jmp 4

---- block 4 ----
temp.100 = int 14
storeprop temp.100, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.100 = int 14
storeprop temp.100, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.100 = int 14
storeprop temp.100, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.100 = int 14
storeprop temp.100, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.100 = int 14
storeprop temp.100, 0
return
