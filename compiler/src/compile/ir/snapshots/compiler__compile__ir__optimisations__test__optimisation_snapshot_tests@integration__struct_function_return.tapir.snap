---
source: compiler/src/compile/ir/optimisations.rs
expression: output
input_file: compiler/src/compile/ir/snapshot_tests/optimisations/integration/struct_function_return.tapir
---
----------- before -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
temp.6.x.60, temp.6.y.61 = make_point(temp.58, temp.59)
p.x.62 = temp.6.x.60
p.y.63 = temp.6.y.61
temp.14.x.64 = p.x.62
temp.14.y.65 = p.y.63
temp.13.x.66, temp.13.y.67 = double_point(temp.14.x.64, temp.14.y.65)
q.x.68 = temp.13.x.66
q.y.69 = temp.13.y.67
temp.24.x.70 = q.x.68
temp.24.y.71 = q.y.69
temp.72 = temp.24.x.70
temp.27.x.73 = q.x.68
temp.27.y.74 = q.y.69
temp.75 = temp.27.y.74
temp.76 = temp.72 + temp.75
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.77 = x.3
temp.78 = y.4
temp.31.x.79 = temp.77
temp.31.y.80 = temp.78
temp.30.x.81 = temp.31.x.79
temp.30.y.82 = temp.31.y.80
return temp.30.x.81, temp.30.y.82

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.47.x.83 = p.x.38
temp.47.y.84 = p.y.39
temp.85 = temp.47.x.83
temp.86 = int 2
temp.87 = temp.85 * temp.86
temp.53.x.88 = p.x.38
temp.53.y.89 = p.y.39
temp.90 = temp.53.y.89
temp.91 = int 2
temp.92 = temp.90 * temp.91
temp.41.x.93 = temp.87
temp.41.y.94 = temp.92
temp.40.x.95 = temp.41.x.93
temp.40.y.96 = temp.41.y.94
return temp.40.x.95, temp.40.y.96


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
temp.6.x.60, temp.6.y.61 = make_point(temp.58, temp.59)
p.x.62 = temp.6.x.60
p.y.63 = temp.6.y.61
temp.14.x.64 = temp.6.x.60
temp.14.y.65 = temp.6.y.61
temp.13.x.66, temp.13.y.67 = double_point(temp.6.x.60, temp.6.y.61)
q.x.68 = temp.13.x.66
q.y.69 = temp.13.y.67
temp.24.x.70 = temp.13.x.66
temp.24.y.71 = temp.13.y.67
temp.72 = temp.13.x.66
temp.27.x.73 = temp.13.x.66
temp.27.y.74 = temp.13.y.67
temp.75 = temp.13.y.67
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
temp.77 = x.3
temp.78 = y.4
temp.31.x.79 = x.3
temp.31.y.80 = y.4
temp.30.x.81 = x.3
temp.30.y.82 = y.4
return x.3, y.4

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.47.x.83 = p.x.38
temp.47.y.84 = p.y.39
temp.85 = p.x.38
temp.86 = int 2
temp.87 = p.x.38 * temp.86
temp.53.x.88 = p.x.38
temp.53.y.89 = p.y.39
temp.90 = p.y.39
temp.91 = int 2
temp.92 = p.y.39 * temp.91
temp.41.x.93 = temp.87
temp.41.y.94 = temp.92
temp.40.x.95 = temp.87
temp.40.y.96 = temp.92
return temp.87, temp.92


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
temp.6.x.60, temp.6.y.61 = make_point(temp.58, temp.59)
temp.13.x.66, temp.13.y.67 = double_point(temp.6.x.60, temp.6.y.61)
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.86 = int 2
temp.87 = p.x.38 * temp.86
temp.91 = int 2
temp.92 = p.y.39 * temp.91
return temp.87, temp.92


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
temp.6.x.60, temp.6.y.61 = make_point(temp.58, temp.59)
temp.13.x.66, temp.13.y.67 = double_point(temp.6.x.60, temp.6.y.61)
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.86 = int 2
temp.97 = int 1
temp.87 = p.x.38 << temp.97
temp.91 = int 2
temp.98 = int 1
temp.92 = p.y.39 << temp.98
return temp.87, temp.92


----------- duplicate_loads -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
temp.6.x.60, temp.6.y.61 = make_point(temp.58, temp.59)
temp.13.x.66, temp.13.y.67 = double_point(temp.6.x.60, temp.6.y.61)
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.86 = int 2
temp.97 = int 1
temp.87 = p.x.38 << temp.97
temp.91 = temp.86
temp.98 = temp.97
temp.92 = p.y.39 << temp.98
return temp.87, temp.92


----------- inline_small_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.99 = φ(temp.58 from 2)
temp.100 = φ(temp.59 from 2)
temp.6.x.60 = temp.99
temp.6.y.61 = temp.100
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.6.x.60 << temp.103
temp.108 = temp.104
temp.105 = temp.103
temp.107 = temp.6.y.61 << temp.105
jmp 8

---- block 8 ----
temp.101 = φ(temp.106 from 6)
temp.102 = φ(temp.107 from 6)
temp.13.x.66 = temp.101
temp.13.y.67 = temp.102
jmp 5

---- block 5 ----
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 

=======================
fn make_point(x.3, y.4) -> int, int

---- block 0 ----
return x.3, y.4

=======================
fn double_point(p.x.38, p.y.39) -> int, int

---- block 0 ----
temp.86 = int 2
temp.97 = int 1
temp.87 = p.x.38 << temp.97
temp.91 = temp.86
temp.98 = temp.97
temp.92 = p.y.39 << temp.98
return temp.87, temp.92


----------- remove_unreferenced_functions -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.99 = φ(temp.58 from 2)
temp.100 = φ(temp.59 from 2)
temp.6.x.60 = temp.99
temp.6.y.61 = temp.100
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.6.x.60 << temp.103
temp.108 = temp.104
temp.105 = temp.103
temp.107 = temp.6.y.61 << temp.105
jmp 8

---- block 8 ----
temp.101 = φ(temp.106 from 6)
temp.102 = φ(temp.107 from 6)
temp.13.x.66 = temp.101
temp.13.y.67 = temp.102
jmp 5

---- block 5 ----
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 


----------- empty_phi -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
temp.6.x.60 = temp.58
temp.6.y.61 = temp.59
jmp 1

---- block 1 ----
jmp 6

---- block 6 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.6.x.60 << temp.103
temp.108 = temp.104
temp.105 = temp.103
temp.107 = temp.6.y.61 << temp.105
jmp 8

---- block 8 ----
temp.13.x.66 = temp.106
temp.13.y.67 = temp.107
jmp 5

---- block 5 ----
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
temp.6.x.60 = temp.58
temp.6.y.61 = temp.59
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.6.x.60 << temp.103
temp.108 = temp.104
temp.105 = temp.103
temp.107 = temp.6.y.61 << temp.105
jmp 6

---- block 6 ----
temp.13.x.66 = temp.106
temp.13.y.67 = temp.107
jmp 8

---- block 8 ----
temp.76 = temp.13.x.66 + temp.13.y.67
storeprop temp.76, 0
jmp 5

---- block 5 ----
return 


----------- copy_propagation -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
temp.6.x.60 = temp.58
temp.6.y.61 = temp.59
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.58 << temp.103
temp.108 = temp.104
temp.105 = temp.103
temp.107 = temp.59 << temp.103
jmp 6

---- block 6 ----
temp.13.x.66 = temp.106
temp.13.y.67 = temp.107
jmp 8

---- block 8 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
jmp 5

---- block 5 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = temp.58 << temp.103
temp.107 = temp.59 << temp.103
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
jmp 5

---- block 5 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 2

---- block 2 ----
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = int 6
temp.107 = int 8
jmp 6

---- block 6 ----
jmp 8

---- block 8 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
jmp 5

---- block 5 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 4

---- block 4 ----
jmp 1

---- block 1 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = int 6
temp.107 = int 8
jmp 8

---- block 8 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.58 = int 3
temp.59 = int 4
jmp 4

---- block 4 ----
temp.104 = int 2
temp.103 = int 1
temp.106 = int 6
temp.107 = int 8
jmp 1

---- block 1 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
jmp 8

---- block 8 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.106 = int 6
temp.107 = int 8
jmp 1

---- block 1 ----
temp.76 = temp.106 + temp.107
storeprop temp.76, 0
jmp 8

---- block 8 ----
return 


----------- constant_folding -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.106 = int 6
temp.107 = int 8
jmp 1

---- block 1 ----
temp.76 = int 14
storeprop temp.76, 0
jmp 8

---- block 8 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.106 = int 6
temp.107 = int 8
jmp 1

---- block 1 ----
temp.76 = int 14
storeprop temp.76, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.106 = int 6
temp.107 = int 8
jmp 4

---- block 4 ----
temp.76 = int 14
storeprop temp.76, 0
jmp 1

---- block 1 ----
return 


----------- dead_store_elimination -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.76 = int 14
storeprop temp.76, 0
jmp 1

---- block 1 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
jmp 4

---- block 4 ----
temp.76 = int 14
storeprop temp.76, 0
return 


----------- simplify_blocks -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 14
storeprop temp.76, 0
jmp 4

---- block 4 ----
return 


----------- empty_block -------------
=======================
fn @toplevel() -> 

---- block 0 ----
temp.76 = int 14
storeprop temp.76, 0
return
